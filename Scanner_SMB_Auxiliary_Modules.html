
		<!DOCTYPE html>
		<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<head>
			<title>Scanner SMB Auxiliary Modules - Metasploit Unleashed</title>
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/reset.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/style.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/main.css" />
			<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		</head>

		<body>
			<div id="wrapper">
			
				<div id="header">
					<div id="header-content">
						<h1><a style="color:#F0F0F0" href="index.html">Metasploit Unleashed</a></h1>
						<div class="tagline">Mastering the Framework</div>
						<div class="clear"></div>
					</div>
				</div>
				
				<div id="page">
					<div id="right-box">
						
						<div id="controls">
									<ul>
			<li id="ca-nstab-main" class="selected"><a href="Scanner_SMB_Auxiliary_Modules" title="View the content page [c]" accesskey="c">Page</a></li>
			<li id="ca-talk" class="new"><a href="http://www.offensive-security.com/w/index.php?title=Talk:Scanner_SMB_Auxiliary_Modules&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
			<li id="ca-viewsource"><a href="http://www.offensive-security.com/w/index.php?title=Scanner_SMB_Auxiliary_Modules&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
			<li id="ca-history"><a href="http://www.offensive-security.com/w/index.php?title=Scanner_SMB_Auxiliary_Modules&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
		</ul>
							
							<div class="portlet" id="p-personal">
								<div class="pBody">
								<ul>
																	</ul>
								</div>
							</div>
							
							<div class="search">
									<div id="p-search" class="portlet">
		<div id="searchBody" class="pBody">
			<form action="http://www.offensive-security.com/w/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Metasploit Unleashed [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
							</div>
							
							<div class="clear"></div>
						</div>
					
						<a id="top"></a>
						
						<div id="content">
							<h1>Scanner SMB Auxiliary Modules</h1>
						
							<div id="siteSub">From Metasploit Unleashed</div>
							<div id="contentSub"></div>
																													<div id="jump-to-nav">Jump to: <a href="Scanner_SMB_Auxiliary_Modules#column-one">navigation</a>, <a href="Scanner_SMB_Auxiliary_Modules#searchInput">search</a></div>
														<!-- start content -->
							<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Scanner_SMB_Auxiliary_Modules#pipe_auditor"><span class="tocnumber">1</span> <span class="toctext">pipe_auditor</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Scanner_SMB_Auxiliary_Modules#pipe_dcerpc_auditor"><span class="tocnumber">2</span> <span class="toctext">pipe_dcerpc_auditor</span></a></li>
<li class="toclevel-1 tocsection-3"><a href="Scanner_SMB_Auxiliary_Modules#smb2"><span class="tocnumber">3</span> <span class="toctext">smb2</span></a></li>
<li class="toclevel-1 tocsection-4"><a href="Scanner_SMB_Auxiliary_Modules#smb_enumshares"><span class="tocnumber">4</span> <span class="toctext">smb_enumshares</span></a></li>
<li class="toclevel-1 tocsection-5"><a href="Scanner_SMB_Auxiliary_Modules#smb_enumusers"><span class="tocnumber">5</span> <span class="toctext">smb_enumusers</span></a></li>
<li class="toclevel-1 tocsection-6"><a href="Scanner_SMB_Auxiliary_Modules#smb_login"><span class="tocnumber">6</span> <span class="toctext">smb_login</span></a></li>
<li class="toclevel-1 tocsection-7"><a href="Scanner_SMB_Auxiliary_Modules#smb_lookupsid"><span class="tocnumber">7</span> <span class="toctext">smb_lookupsid</span></a></li>
<li class="toclevel-1 tocsection-8"><a href="Scanner_SMB_Auxiliary_Modules#smb_version"><span class="tocnumber">8</span> <span class="toctext">smb_version</span></a></li>
</ul>
</td></tr></table>
<p><br />
</p>
<h2> <span class="mw-headline" id="pipe_auditor"> pipe_auditor </span></h2>
<p>The pipe_auditor scanner will determine what named pipes are available over SMB.  In your information gathering stage, this can provide you with some insight as to some of the services that are running on the remote system.
<br />
<br />
<pre>
msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/pipe_auditor</span> 
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(pipe_auditor) >
</pre>
<br />
To run the scanner, just pass, at a minimum, the RHOSTS value to the module and run it.
<br />
<br />
<pre>
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-160</span>
RHOSTS => 192.168.1.150-160
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>set THREADS 11</span>
THREADS => 11
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.150 - Pipes: \browser
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 - Pipes: \browser
<span style='color:#0000FF;'>[*]</span> Scanned 02 of 11 hosts (018% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 10 of 11 hosts (090% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 11 of 11 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
</pre>
<br />
We can see that running the scanner without credentials does not return a great deal of information. If, however, you have been provided with credentials as part of a pentest, you will find that the pipe_auditor scanner returns a great deal more information.
<br />
<br />
<pre>
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>set SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.150 - Pipes: \netlogon, \lsarpc, \samr, \browser, \atsvc, \DAV RPC SERVICE, \epmapper, \eventlog, \InitShutdown, \keysvc, \lsass, \ntsvcs, \protected_storage, \scerpc, \srvsvc, \trkwks, \wkssvc
<span style='color:#0000FF;'>[*]</span> Scanned 02 of 11 hosts (018% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 - Pipes: \netlogon, \lsarpc, \samr, \browser, \atsvc, \DAV RPC SERVICE, \epmapper, \eventlog, \InitShutdown, \keysvc, \lsass, \ntsvcs, \protected_storage, \router, \scerpc, \srvsvc, \trkwks, \wkssvc
<span style='color:#0000FF;'>[*]</span> Scanned 04 of 11 hosts (036% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 08 of 11 hosts (072% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 09 of 11 hosts (081% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 11 of 11 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>pipe_auditor</span>) >
</pre>
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="pipe_dcerpc_auditor"> pipe_dcerpc_auditor </span></h2>
<p>The pipe_dcerpc_auditor scanner will return the DCERPC services that can be accessed via a SMB pipe.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/pipe_dcerpc_auditor</span>
msf auxiliary(<span style='color:#ff0000;'>pipe_dcerpc_auditor</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting    Required  Description
   ----       ---------------    --------  -----------
   RHOSTS     192.168.1.150-160  yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP          no        The Windows domain to use for authentication
   SMBPIPE    BROWSER            yes       The pipe name to use (BROWSER)
   SMBPass                       no        The password for the specified username
   SMBUser                       no        The username to authenticate as
   THREADS    11                 yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>pipe_dcerpc_auditor</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-160</span>
RHOSTS => 192.168.1.150-160
msf auxiliary(<span style='color:#ff0000;'>pipe_dcerpc_auditor</span>) > <span style='color:#13C16A;'>set THREADS 11</span>
THREADS => 11
msf auxiliary(<span style='color:#ff0000;'>pipe_dcerpc_auditor</span>) > <span style='color:#13C16A;'>run</span>

The connection was refused by the remote host (192.168.1.153:139).
The connection was refused by the remote host (192.168.1.153:445).
192.168.1.160 - UUID 00000131-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
192.168.1.150 - UUID 00000131-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
192.168.1.160 - UUID 00000134-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
192.168.1.150 - UUID 00000134-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
192.168.1.150 - UUID 00000143-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
192.168.1.160 - UUID 00000143-0000-0000-c000-000000000046 0.0 OPEN VIA BROWSER
<span style='color:#00ff00;'>...snip...</span></pre>
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb2"> smb2 </span></h2>
<p>The SMB2 scanner module simply scans the remote hosts and determines if they support the SMB2 protocol.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb2</span>
msf auxiliary(<span style='color:#ff0000;'>smb2</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name     Current Setting  Required  Description
   ----     ---------------  --------  -----------
   RHOSTS                    yes       The target address range or CIDR identifier
   RPORT    445              yes       The target port
   THREADS  1                yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>smb2</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb2</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb2</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.162 supports SMB 2 [dialect 255.2] and has been online for 618 hours
<span style='color:#0000FF;'>[*]</span> Scanned 06 of 16 hosts (037% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 13 of 16 hosts (081% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 14 of 16 hosts (087% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb2</span>) ></pre>
<br />
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb_enumshares"> smb_enumshares </span></h2>
<p>The smb_enumshares module, as would be expected, enumerates any SMB shares that are available on a remote system.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb_enumshares</span>
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.154:139 print$ - Printer Drivers (DISK), tmp - oh noes! (DISK), opt -  (DISK), IPC$ - IPC Service (metasploitable server (Samba 3.0.20-Debian)) (IPC), ADMIN$ - IPC Service (metasploitable server (Samba 3.0.20-Debian)) (IPC)
Error: 192.168.1.160 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)
Error: 192.168.1.160 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)
Error: 192.168.1.162 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)
Error: 192.168.1.150 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)
Error: 192.168.1.150 Rex::Proto::SMB::Exceptions::ErrorCode The server responded with error: STATUS_ACCESS_DENIED (Command=37 WordCount=0)
<span style='color:#0000FF;'>[*]</span> Scanned 06 of 16 hosts (037% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 09 of 16 hosts (056% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 10 of 16 hosts (062% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 14 of 16 hosts (087% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) ></pre>
<br />
As you can see, since this is an un-credentialed scan, access is denied a most of the systems that are probed.  Passing user credentials to the scanner will produce much different results.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > s<span style='color:#13C16A;'>et SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#0000FF;'>smb_enumshares</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.161:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)
<span style='color:#0000FF;'>[*]</span> 192.168.1.160:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)
<span style='color:#0000FF;'>[*]</span> 192.168.1.150:139 IPC$ - Remote IPC (IPC), ADMIN$ - Remote Admin (DISK), C$ - Default share (DISK)
<span style='color:#0000FF;'>[*]</span> Scanned 06 of 16 hosts (037% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 07 of 16 hosts (043% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 12 of 16 hosts (075% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_enumshares</span>) ></pre>
<br />
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb_enumusers"> smb_enumusers </span></h2>
<p>The smb_enumusers scanner will connect to each system via the SMB RPC service and enumerate the users on the system.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb_enumusers</span>
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.161 XEN-XP-SP2-BARE [  ] 
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 METASPLOITABLE [ games, nobody, bind, proxy, syslog, user, www-data, root, news, postgres, bin, mail, distccd, proftpd, dhcp, daemon, sshd, man, lp, mysql, gnats, libuuid, backup, msfadmin, telnetd, sys, klog, postfix, service, list, irc, ftp, tomcat55, sync, uucp ] ( LockoutTries=0 PasswordMin=5 )
<span style='color:#0000FF;'>[*]</span> Scanned 05 of 16 hosts (031% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 12 of 16 hosts (075% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed</pre>
<br />
We can see that running the scan without credentials, only the Linux Samba service coughs up a listing of users.  Passing a valid set of credentials to the scanner will enumerate the users on our other targets.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>set SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.150 V-XPSP2-SPLOIT- [ Administrator, Guest, HelpAssistant, SUPPORT_388945a0 ] 
<span style='color:#0000FF;'>[*]</span> Scanned 04 of 16 hosts (025% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 XEN-XP-SP2-BARE [ Administrator, Guest, HelpAssistant, SUPPORT_388945a0, victim ] 
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 XEN-XP-PATCHED [ Administrator, ASPNET, Guest, HelpAssistant, SUPPORT_388945a0 ] 
<span style='color:#0000FF;'>[*]</span> Scanned 09 of 16 hosts (056% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 13 of 16 hosts (081% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_enumusers</span>) ></pre>
<br />
Now that we have passed credentials to the scanner, the Linux box doesn't return the set of users because the credentials are not valid for that system. This is an example of why it pays to run a scanner in different configurations.
<br />
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb_login"> smb_login </span></h2>
<p>Metasploit's smb_login module will attempt to login via SMB across a provided range of IP addresses.  If you have a database plugin loaded, successful logins will be stored in it for future reference and usage.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb_login</span>
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   true             yes       Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target address range or CIDR identifier
   RPORT             445              yes       Set the SMB service port
   SMBDomain         WORKGROUP        no        SMB Domain
   SMBPass                            no        SMB Password
   SMBUser                            no        SMB Username
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts</pre>
<br />
You can clearly see that this module has many more options that other auxiliary modules and is quite versatile.  We will first run a scan using the Administrator credentials we 'found'.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> Starting SMB login attempt on 192.168.1.165
<span style='color:#0000FF;'>[*]</span> Starting SMB login attempt on 192.168.1.153
<span style='color:#00ff00;'>...snip...</span>
<span style='color:#0000FF;'>[*]</span> Starting SMB login attempt on 192.168.1.156
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 - FAILED LOGIN () Administrator :  (STATUS_LOGON_FAILURE)
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 - FAILED LOGIN (Windows 5.1) Administrator :  (STATUS_LOGON_FAILURE)
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 - FAILED LOGIN (Windows 5.1) Administrator :  (STATUS_LOGON_FAILURE)
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 - FAILED LOGIN () Administrator : s3cr3t (STATUS_LOGON_FAILURE)
<span style='color:#ff0000;'>[-]</span> 192.168.1.162 - FAILED LOGIN (Windows 7 Enterprise 7600) Administrator :  (STATUS_ACCOUNT_DISABLED)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 - FAILED LOGIN (Windows 5.1) Administrator :  (STATUS_LOGON_FAILURE)
<span style='color:#00ff00;'>[+]</span> 192.168.1.150 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#0000FF;'>[*]</span> Scanned 04 of 16 hosts (025% complete)
<span style='color:#00ff00;'>[+]</span> 192.168.1.160 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#00ff00;'>[+]</span> 192.168.1.161 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#0000FF;'>[*]</span> Scanned 13 of 16 hosts (081% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 14 of 16 hosts (087% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) ></pre>
<br />
The smb_login module can also be passed a username and password list in order to attempt to brute-force login attempts across a range of machines.
<br />
<br />
<pre><span style='color:#ff0000;'>root@kali</span>:~# <span style='color:#13C16A;'>cat users.txt</span>
Administrator
dale
chip
dookie
victim
jimmie

<span style='color:#ff0000;'>root@kali</span>:~# <span style='color:#13C16A;'>cat passwords.txt</span>
password
god
password123
s00pers3kr1t
s3cr3t</pre>
<br />
We will use this limited set of usernames and passwords and run the scan again.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name              Current Setting  Required  Description
   ----              ---------------  --------  -----------
   BLANK_PASSWORDS   true             yes       Try blank passwords for all users
   BRUTEFORCE_SPEED  5                yes       How fast to bruteforce, from 0 to 5
   PASS_FILE                          no        File containing passwords, one per line
   RHOSTS                             yes       The target address range or CIDR identifier
   RPORT             445              yes       Set the SMB service port
   SMBDomain         WORKGROUP        no        SMB Domain
   SMBPass                            no        SMB Password
   SMBUser                            no        SMB Username
   STOP_ON_SUCCESS   false            yes       Stop guessing when a credential works for a host
   THREADS           1                yes       The number of concurrent threads
   USERPASS_FILE                      no        File containing users and passwords separated by space, one pair per line
   USER_FILE                          no        File containing usernames, one per line
   VERBOSE           true             yes       Whether to print output for all attempts

msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set PASS_FILE /root/passwords.txt</span>
PASS_FILE => /root/passwords.txt
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set USER_FILE /root/users.txt</span>
USER_FILE => /root/users.txt
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>set VERBOSE false</span>
VERBOSE => false
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#ff0000;'>[-]</span> 192.168.1.162 - FAILED LOGIN (Windows 7 Enterprise 7600) Administrator :  (STATUS_ACCOUNT_DISABLED)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 - GUEST LOGIN (Windows 5.1) dale :
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 - GUEST LOGIN (Windows 5.1) chip :
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 - GUEST LOGIN (Windows 5.1) dookie :
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 - GUEST LOGIN (Windows 5.1) jimmie :
<span style='color:#00ff00;'>[+]</span> 192.168.1.150 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#00ff00;'>[+]</span> 192.168.1.160 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#00ff00;'>[+]</span> 192.168.1.161 - SUCCESSFUL LOGIN (Windows 5.1) 'Administrator' : 's3cr3t'
<span style='color:#00ff00;'>[+]</span> 192.168.1.161 - SUCCESSFUL LOGIN (Windows 5.1) 'victim' : 's3cr3t'
<span style='color:#00ff00;'>[+]</span> 192.168.1.162 - SUCCESSFUL LOGIN (Windows 7 Enterprise 7600) 'victim' : 's3cr3t'
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_login</span>) ></pre>
<br />
There are many more options available that you should experiment with to fully familiarize yourself with this extremely valuable module.
<br />
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb_lookupsid"> smb_lookupsid </span></h2>
<p>The smb_lookupsid module brute-forces SID lookups on a range of targets to determine what local users exist the system.  Knowing what users exist on a system can greatly speed up any further brute-force logon attempts later on.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb_lookupsid</span>
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.161 PIPE(LSARPC) LOCAL(XEN-XP-SP2-BARE - 5-21-583907252-1801674531-839522115) DOMAIN(HOTZONE - )
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 PIPE(LSARPC) LOCAL(METASPLOITABLE - 5-21-1042354039-2475377354-766472396) DOMAIN(WORKGROUP - )
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=Administrator RID=500
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 USER=Administrator RID=500
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=Guest RID=501
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 USER=nobody RID=501
<span style='color:#0000FF;'>[*]</span> Scanned 04 of 16 hosts (025% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 GROUP=Domain Admins RID=512
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 GROUP=None RID=513
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 GROUP=Domain Users RID=513
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 GROUP=Domain Guests RID=514
<span style='color:#0000FF;'>[*]</span> Scanned 07 of 16 hosts (043% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 USER=root RID=1000
<span style='color:#00ff00;'>...snip...</span>
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 GROUP=service RID=3005
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 METASPLOITABLE [Administrator, nobody, root, daemon, bin, sys, sync, games, man, lp, mail, news, uucp, proxy, www-data, backup, list, irc, gnats, libuuid, dhcp, syslog, klog, sshd, bind, postfix, ftp, postgres, mysql, tomcat55, distccd, telnetd, proftpd, msfadmin, user, service ]
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 XEN-XP-SP2-BARE [Administrator, Guest, HelpAssistant, SUPPORT_388945a0, victim ]
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) ></pre>
<br />
By way of comparison, we will also run the scan using a known set of user credentials to see the difference in output.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>set SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.160 PIPE(LSARPC) LOCAL(XEN-XP-PATCHED - 5-21-583907252-1801674531-839522115) DOMAIN(HOTZONE - )
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 PIPE(LSARPC) LOCAL(XEN-XP-SP2-BARE - 5-21-583907252-1801674531-839522115) DOMAIN(HOTZONE - )
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=Administrator RID=500
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 USER=Administrator RID=500
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 PIPE(LSARPC) LOCAL(V-XPSP2-SPLOIT- - 5-21-2000478354-1965331169-725345543) DOMAIN(WORKGROUP - )
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 USER=Guest RID=501
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886081 NAME=Administrator rid=500
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=Guest RID=501
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886081 NAME=Guest rid=501
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 GROUP=None RID=513
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886082 NAME=None rid=513
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 GROUP=None RID=513
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886081 NAME=HelpAssistant rid=1000
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886084 NAME=HelpServicesGroup rid=1001
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=83886081 NAME=SUPPORT_388945a0 rid=1002
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=3276804 NAME=SQLServerMSSQLServerADHelperUser$DOOKIE-FA154354 rid=1003
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 TYPE=4 NAME=SQLServer2005SQLBrowserUser$DOOKIE-FA154354 rid=1004
<span style='color:#00ff00;'>...snip...</span>
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 TYPE=651165700 NAME=SQLServer2005MSSQLServerADHelperUser$XEN-XP-PATCHED rid=1027
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 TYPE=651165700 NAME=SQLServer2005MSSQLUser$XEN-XP-PATCHED$SQLEXPRESS rid=1028
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=HelpAssistant RID=1000
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 TYPE=4 NAME=HelpServicesGroup rid=1001
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=SUPPORT_388945a0 RID=1002
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 USER=victim RID=1004
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 XEN-XP-PATCHED [Administrator, Guest, HelpAssistant, SUPPORT_388945a0, ASPNET ]
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 V-XPSP2-SPLOIT- [ ]
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 XEN-XP-SP2-BARE [Administrator, Guest, HelpAssistant, SUPPORT_388945a0, victim ]
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_lookupsid</span>) ></pre>
<br />
You will notice with credentialed scanning, that you get, as always, a great deal more interesting output, including accounts you likely never knew existed.
<br />
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="smb_version"> smb_version </span></h2>
<p>The smb_version scanner connects to each workstation in a given range of hosts and determines the version of the SMB service that is running.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use auxiliary/scanner/smb/smb_version</span>
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOSTS                      yes       The target address range or CIDR identifier
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as
   THREADS    1                yes       The number of concurrent threads

msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>set RHOSTS 192.168.1.150-165</span>
RHOSTS => 192.168.1.150-165
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>set THREADS 16</span>
THREADS => 16
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.162 is running Windows 7 Enterprise (Build 7600) (language: Unknown) (name:XEN-WIN7-BARE) (domain:HOTZONE)
<span style='color:#0000FF;'>[*]</span> 192.168.1.154 is running Unix Samba 3.0.20-Debian (language: Unknown) (domain:WORKGROUP)
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 is running Windows XP Service Pack 2 (language: English) (name:V-XPSP2-SPLOIT-) (domain:WORKGROUP)
<span style='color:#0000FF;'>[*]</span> Scanned 04 of 16 hosts (025% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.160 is running Windows XP Service Pack 3 (language: English) (name:XEN-XP-PATCHED) (domain:HOTZONE)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 is running Windows XP Service Pack 2 (language: English) (name:XEN-XP-SP2-BARE) (domain:XEN-XP-SP2-BARE)
<span style='color:#0000FF;'>[*]</span> Scanned 11 of 16 hosts (068% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 14 of 16 hosts (087% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed</pre>
<br />
Running this same scan with a set of credentials will return some different, and perhaps unexpected, results.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>set SMBPass s3cr3t</span>
SMBPass => s3cr3t
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 192.168.1.160 is running Windows XP Service Pack 3 (language: English) (name:XEN-XP-PATCHED) (domain:XEN-XP-PATCHED)
<span style='color:#0000FF;'>[*]</span> 192.168.1.150 is running Windows XP Service Pack 2 (language: English) (name:V-XPSP2-SPLOIT-) (domain:V-XPSP2-SPLOIT-)
<span style='color:#0000FF;'>[*]</span> Scanned 05 of 16 hosts (031% complete)
<span style='color:#0000FF;'>[*]</span> 192.168.1.161 is running Windows XP Service Pack 2 (language: English) (name:XEN-XP-SP2-BARE) (domain:XEN-XP-SP2-BARE)
<span style='color:#0000FF;'>[*]</span> Scanned 12 of 16 hosts (075% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 14 of 16 hosts (087% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 15 of 16 hosts (093% complete)
<span style='color:#0000FF;'>[*]</span> Scanned 16 of 16 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>smb_version</span>) ></pre>
<br />
Contrary to many other cases, a credentialed scan in this case does not necessarily give better results.  If the credentials are not valid on a particular system, you will not get any result back from the scan.
<br />
<br />
</p>
<hr />
<p><br />






































</p>
<div class="Total1"><a href="http://www.offensive-security.com/w/index.php?title=Module_Reference&amp;action=edit&amp;redlink=1" class="new" title="Module Reference (page does not exist)">Module Reference</a> &gt; <a href="http://www.offensive-security.com/w/index.php?title=Auxiliary_Modules&amp;action=edit&amp;redlink=1" class="new" title="Auxiliary Modules (page does not exist)">Auxiliary Modules</a> &gt; <a href="http://www.offensive-security.com/w/index.php?title=Scanner_Modules&amp;action=edit&amp;redlink=1" class="new" title="Scanner Modules (page does not exist)">Scanner Modules</a> &gt; Scanner SMB Auxiliary Modules</div>
<p>











































</p>
<div class="Total2"><a href="http://www.offensive-security.com/w/index.php?title=DCERPC&amp;action=edit&amp;redlink=1" class="new" title="DCERPC (page does not exist)">DCERPC</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=Discovery&amp;action=edit&amp;redlink=1" class="new" title="Discovery (page does not exist)">Discovery</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=FTP&amp;action=edit&amp;redlink=1" class="new" title="FTP (page does not exist)">FTP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=HTTP&amp;action=edit&amp;redlink=1" class="new" title="HTTP (page does not exist)">HTTP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=IMAP&amp;action=edit&amp;redlink=1" class="new" title="IMAP (page does not exist)">IMAP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=MSSQL&amp;action=edit&amp;redlink=1" class="new" title="MSSQL (page does not exist)">MSSQL</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=MySQL&amp;action=edit&amp;redlink=1" class="new" title="MySQL (page does not exist)">MySQL</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=NetBIOS&amp;action=edit&amp;redlink=1" class="new" title="NetBIOS (page does not exist)">NetBIOS</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=POP3&amp;action=edit&amp;redlink=1" class="new" title="POP3 (page does not exist)">POP3</a> &#124; <a href="Port_Scanners" title="Port Scanners" class="mw-redirect">Port Scanners</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=SMB&amp;action=edit&amp;redlink=1" class="new" title="SMB (page does not exist)">SMB</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=SMTP&amp;action=edit&amp;redlink=1" class="new" title="SMTP (page does not exist)">SMTP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=SNMP&amp;action=edit&amp;redlink=1" class="new" title="SNMP (page does not exist)">SNMP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=SSH&amp;action=edit&amp;redlink=1" class="new" title="SSH (page does not exist)">SSH</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=Telnet&amp;action=edit&amp;redlink=1" class="new" title="Telnet (page does not exist)">Telnet</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=TFTP&amp;action=edit&amp;redlink=1" class="new" title="TFTP (page does not exist)">TFTP</a> &#124; <a href="http://www.offensive-security.com/w/index.php?title=VNC&amp;action=edit&amp;redlink=1" class="new" title="VNC (page does not exist)">VNC</a></div>
<p>














































</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 725/1000000
Preprocessor generated node count: 3075/1000000
Post‐expand include size: 5370/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key MSFU_Mediawiki-msfum_:pcache:idhash:250-0!*!0!!en!*!* and timestamp 20131123142056 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.offensive-security.com/w/index.php?title=Scanner_SMB_Auxiliary_Modules&amp;oldid=1549">http://www.offensive-security.com/w/index.php?title=Scanner_SMB_Auxiliary_Modules&amp;oldid=1549</a>"</div>
							<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://www.offensive-security.com/w/index.php?title=Category:Scanner_Modules&amp;action=edit&amp;redlink=1" class="new" title="Category:Scanner Modules (page does not exist)">Scanner Modules</a></li></ul></div></div>							<!-- end content -->
													</div>
						
					</div>
				
					<div id="left-box">
								<ul id="nav">
				<li><a href="Donate" class="root">Donate</a></li>
				<li>
					<a href="Introduction" class="root"><span class="chapter">01</span> Introduction</a>
					<div class="menu two-column">
						<h3>Introduction</h3>
						<ul class="one">
							<li><a href="Metasploit_Architecture">Metasploit Architecture</a>
								<ul class="two small">
									<li><a href="Filesystem_And_Libraries">Filesystem And Libraries</a></li>
									<li><a href="Modules_And_Locations">Modules And Locations</a></li>
									<li><a href="Metasploit_Object_Model">Metasploit Object Model</a></li>
									<li><a href="Mixins_And_Plugins">Mixins And Plugins</a></li>
								</ul>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
					<a href="Requirements" class="root"><span class="chapter">02</span> Requirements</a>
					<div class="menu two-column">
						<h3>Required Materials</h3>
						<ul class="one">
							<li><a href="Metasploitable">Metasploitable</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Metasploit_Fundamentals" class="root"><span class="chapter">03</span>Metasploit Fundamentals</a>
					<div class="menu four-column">
						<h3>Metasploit Fundamentals</h3>
						<ul class="one">
							<li><a href="Msfcli">Msfcli</a></li>
							<li><a href="Msfconsole">Msfconsole</a>
								<ul class="two small">
									<li><a href="Msfconsole_Commands">Msfconsole Commands</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Exploits">Exploits</a>
								<ul class="two">
									<li><a href="Using_Exploits">Using Exploits</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Payloads">Payloads</a>
								<ul class="two small">
									<li><a href="Payload_Types">Payload Types</a></li>
									<li><a href="Generating_Payloads">Generating Payloads</a></li>
								</ul>
								<div class="clear"></div>
							</li>
                                                        <li><a href="Databases">Databases</a>
                                                                <ul class="two small">
                                                                        <li><a href="Using_the_Database">Using the Database</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
							<li><a href="About_Meterpreter">About Meterpreter</a>
								<ul class="two">
									<li><a href="Meterpreter_Basics">Meterpreter Basics</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
				<a href="Information_Gathering" class="root"><span class="chapter">04</span> Information Gathering</a>
					<div class="menu two-column">
						<h3>Information Gathering</h3>
						<ul class="one">
							<li><a href="Port_Scanning">Port Scanning</a></li>
							<li><a href="Hunting_For_MSSQL">Hunting For MSSQL</a></li>
							<li><a href="Service_Identification">Service Identification</a></li>
							<li><a href="Password_Sniffing">Password Sniffing</a>
								<ul class="two">
									<li><a href="Extending_Psnuffle">Extending Psnuffle</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="SNMP_Sweeping">SNMP Sweeping</a></li>
							<li><a href="Writing_Your_Own_Scanner">Writing Your Own Scanner</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Vulnerability_Scanning" class="root"><span class="chapter">05</span> Vulnerability Scanning</a>
					<div class="menu two-column">
						<h3>Vulnerability Scanning</h3>
						<ul class="one">
							<li><a href="SMB_Login_Check">SMB Login Check</a></li>
							<li><a href="VNC_Authentication">VNC Authentication</a></li>
							<li><a href="WMAP_Web_Scanner">WMAP Web Scanner</a></li>
							<li><a href="Working_With_NeXpose">Working With NeXpose</a>
		     		                                <ul class="two small">
                                                                        <li><a href="NeXpose_Via_Msfconsole">NeXpose Via Msfconsole</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							</li>
                                                        <li><a href="Working_With_Nessus">Working With Nessus</a>
								<ul class="two small">
									<li><a href="Nessus_Via_Msfconsole">Nessus Via Msfconsole</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Writing_A_Simple_Fuzzer" class="root"><span class="chapter">06</span> Writing A Simple Fuzzer</a>
					<div class="menu two-column">
						<h3>Writing a Simple Fuzzer</h3>
						<ul class="one">
							<li><a href="Simple_TFTP_Fuzzer">Simple TFTP Fuzzer</a></li>
							<li><a href="Simple_IMAP_Fuzzer">Simple IMAP Fuzzer</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Exploit_Development" class="root"><span class="chapter">07</span> Exploit Development</a>
					<div class="menu two-column">
						<h3>Exploit Development</h3>
						<ul class="one">
							<li><a href="Exploit_Design_Goals">Exploit Design Goals</a></li>
							<li><a href="Exploit_Format">Exploit Format</a></li>
							<li><a href="Exploit_Mixins">Exploit Mixins</a></li>
							<li><a href="Exploit_Targets">Exploit Targets</a></li>
							<li><a href="Exploit_Payloads">Exploit Payloads</a>
								<ul class="two small">
									<li><a href="Msfvenom">Msfvenom</a></li>
									<li><a href="Msfpayload">Msfpayload</a></li>
									<li><a href="Msfencode">Msfencode</a></li>
									<li><a href="Alphanumeric_Shellcode">Alphanumeric Shellcode</a></li>
									<li><a href="Msfrop">Msfrop</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Writing_An_Exploit">Writing An Exploit</a>
								<ul class="two small">
									<li><a href="Getting_A_Shell">Getting A Shell</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Using_The_Egghunter_Mixin">Using The Egghunter Mixin</a>
								<ul class="two small">
									<li><a href="Completing_The_Exploit">Completing The Exploit</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Porting_Exploits">Porting Exploits</a></li>
						</ul>
					</div>
				</li>
                                <li>
                                        <a href="Web_App_Exploit_Dev" class="root"><span class="chapter">08</span> Web App Exploit Dev</a>
                                        <div class="menu two-column">
                                                <h3>Client-side Exploits</h3>
                                                <ul class="one">
                                                        <li><a href="Installing_dotDefender">Installing dotDefender</a></li>
                                                        <li><a href="Analyzing_the_Exploit">Analyzing the Exploit</a></li>
                                                        <li><a href="Skeleton_Creation">Skeleton Creation</a></li>
                                                        <li><a href="Making_A_Log_Entry">Making A Log Entry</a></li>
                                                        <li><a href="Hosting_the_Javascript">Hosting the Javascript</a></li>
                                                        <li><a href="Final_Exploit">Final Exploit</a></li>
                                                </ul>
                                        </div>
                                </li>
				<li>
					<a href="Client_Side_Attacks" class="root"><span class="chapter">09</span> Client Side Attacks</a>
					<div class="menu three-column">
						<h3>Client Side Attacks</h3>
						<ul class="one">
							<li><a href="Binary_Payloads">Binary Payloads</a></li>
							<ul class="two small">
								<li><a href="Binary_Linux_Trojan">Binary Linux Trojan</a></li>
							</ul>
							<div class="clear"></div>
							<li><a href="Client_Side_Exploits">Client Side Exploits</a></li>
							<li><a href="VBScript_Infection_Methods">VBScript Infection Methods</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Post_Exploitation" class="root"><span class="chapter">10</span> MSF Post Exploitation</a>
					<div class="menu two-column">
						<h3>MSF Post Exploitation</h3>
						<ul class="one">
							<li><a href="Privilege_Escalation">Privilege Escalation</a></li>
							<li><a href="PSExec_Pass_The_Hash">PSExec Pass the Hash</a></li>
							<li><a href="Event_Log_Management">Event Log Management</a></li>
							<li><a href="Fun_With_Incognito">Fun with Incognito</a></li>
							<li><a href="Interacting_With_The_Registry">Interacting with the Registry</a>
								<ul class="two small">
									<li><a href="Persistent_Netcat_Backdoor">Persistent Netcat Backdoor</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Enabling_Remote_Desktop">Enabling Remote Desktop</a></li>
							<li><a href="Packet_Sniffing">Packet Sniffing</a></li>
							<li><a href="Pivoting">Pivoting</a></li>
                                                                <ul class="two small">
                                                                        <li><a href="Portfwd">Portfwd</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							<li><a href="TimeStomp">TimeStomp</a></li>
							<li><a href="Screen_Capture">Screen Capture</a></li>
							<li><a href="Searching_For_Content">Searching For Content</a></li>
							<li><a href="John_The_Ripper">John The Ripper</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Meterpreter_Scripting" class="root"><span class="chapter">11</span> Meterpreter Scripting</a>
					<div class="menu two-column">
						<h3>Meterpreter Scripting</h3>
						<ul class="one">
							<li><a href="Existing_Scripts">Existing Scripts</a></li>
							<li><a href="Writing_Meterpreter_Scripts">Writing Meterpreter Scripts</a></li>
							<li><a href="Custom_Scripting">Custom Scripting</a></li>
							<li><a href="Useful_API_Calls">Useful API Calls</a></li>
							<li><a href="Useful_Functions">Useful Functions</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Maintaining_Access" class="root"><span class="chapter">12</span> Maintaining Access</a>
					<div class="menu two-column">
						<h3>Maintaining Access</h3>
						<ul class="one">
							<li><a href="Keylogging">Keylogging</a></li>
							<li><a href="Meterpreter_Backdoor">Meterpreter Backdoor</a></li>
							<li><a href="Persistent_Backdoors">Persistent Backdoors</a></li>
						        <ul class="two small">
								 <li><a href="Netcat_Backdoor">Netcat Backdoor</a></li>
		 						 <li><a href="Meterpreter_Service">Meterpreter Service</a></li>
							</ul>
								 <div class="clear"></div>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Extended_Usage" class="root"><span class="chapter">13</span> MSF Extended Usage</a>
					<div class="menu two-column">
						<h3>MSF Extended Usage</h3>
						<ul class="one">
							<li><a href="PHP_Meterpreter">PHP Meterpreter</a></li>
							<li><a href="Backdooring_EXE_Files">Backdooring EXE Files</a></li>
							<li><a href="Karmetasploit">Karmetasploit</a>
								<ul class="two small">
									<li><a href="Karmetasploit_Configuration">Configuration</a></li>
									<li><a href="Karmetasploit_In_Action">Karmetasploit in Action</a></li>
									<li><a href="Attack_Analysis">Attack Analysis</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="MSF_vs_OS_X">MSF vs OS X</a></li>
							<li><a href="File-Upload_Backdoors">File-Upload Backdoors</a></li>
							<li><a href="Building_A_Module">Building A Module</a>
								<ul class="two small">
									<li><a href="Payloads_Through_MSSQL">Payloads Through MSSQL</a></li>
									<li><a href="Creating_Our_Auxiliary_Module">Creating Our Auxiliary Module</a></li>
									<li><a href="The_Guts_Behind_It">The Guts Behind It</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
                                        <a href="Metasploit_GUIs" class="root"><span class="chapter">14</span> Metasploit GUIs</a>
					<div class="menu two-column">
						<h3>Metasploit GUIs</h3>
						<ul class="one">
							<li><a href="MSF_Community_Edition">MSF Community Edition</a>
								<ul class="two small">
                                                                        <li><a href="Scanning">Scanning</a></li>
                                                                        <li><a href="Exploitation">Exploitation</a></li>
                                                                        <li><a href="Post_Exploitation">Post Exploitation</a></li>
                                                                </ul>
								<div class="clear"></div>
                                                        </li>
							<li><a href="Armitage">Armitage</a>
                                                                <ul class="two small">
                                                                        <li><a href="Armitage_Setup">Armitage Setup</a></li>
                                                                        <li><a href="Armitage_Scanning">Armitage Scanning</a></li>
                                                                        <li><a href="Armitage_Exploitation">Armitage Exploitation</a></li>
                                                                	<li><a href="Armitage_Post_Exploitation">Armitage Post Exploitation</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</li>
				<li><a href="About_The_Authors" class="root">About The Authors</a>
					<div class="menu two-column">
						<h3>About the Authors</h3>
						<ul class="one">
							<li><a href="Mati_Aharoni">Mati Aharoni</a></li>
							<li><a href="William_Coppola">William Coppola</a></li>
							<li><a href="Paul_Hand">Paul Hand</a></li>
							<li><a href="Alain_Hernandez">Alain Hernandez</a></li>
							<li><a href="Devon_Kearns">Devon Kearns</a></li>
							<li><a href="David_Kennedy">David Kennedy</a></li>
							<li><a href="Steven_McElrea">Steven McElrea</a></li>
							<li><a href="Matteo_Memelli">Matteo Memelli</a></li>
							<li><a href="http://www.offensive-security.com/metasploit-unleashed/Jim_O'Gorman">Jim O'Gorman</a></li>
							<li><a href="David_Ovitz">David Ovitz</a></li>
							<li><a href="Carlos_Perez">Carlos Perez</a></li>
						</ul>
					</div>
				</li>
                                <li><a href="Post_Module_Reference" class="root">Post Module Reference</a>    
                                        <div class="menu three-column">
                                                <h3>Post Module Reference</h3>
                                                <ul class="one">
                                                        <li>Windows   
                                                                <ul class="two">
                                                                        <li><a href="Windows_Post_Capture_Modules">Capture</a></li>
                                                                        <li><a href="Windows_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Windows_Post_Manage_Modules">Manage</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Linux
                                                                <ul class="two">
                                                                        <li><a href="Linux_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>OS X
                                                                <ul class="two">
                                                                        <li><a href="OS_X_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                        <li>Multiple OS
                                                                <ul class="two">
                                                                        <li><a href="Multiple_OS_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Multiple_OS_Post_General_Modules">General</a></li>
                                                                </ul>
							                                	<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
                                <li><a href="Auxiliary_Module_Reference" class="root">Auxiliary Module Reference</a>    
                                        <div class="menu four-column">
                                                <h3>Auxiliary Module Reference</h3>
                                                <ul class="one">
                                                        <li>Admin   
                                                                <ul class="two">
                                                                        <li><a href="Admin_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Admin_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Admin_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Admin_Postgres_Auxiliary_Modules">Postgres</a></li>
                                                                        <li><a href="Admin_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Scanner
                                                                <ul class="two">
                                                                        <li><a href="Scanner_DCERPC_Auxiliary_Modules">DCERPC</a></li>
                                                                        <li><a href="Scanner_Discovery_Auxiliary_Modules">Discovery</a></li>
                                                                        <li><a href="Scanner_FTP_Auxiliary_Modules">FTP</a></li>
                                                                        <li><a href="Scanner_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Scanner_IMAP_Auxiliary_Modules">IMAP</a></li>
                                                                        <li><a href="Scanner_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Scanner_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Scanner_NetBIOS_Auxiliary_Modules">NetBIOS</a></li>
                                                                        <li><a href="Scanner_POP3_Auxiliary_Modules">POP3</a></li>
                                                                        <li><a href="Scanner_SMB_Auxiliary_Modules">SMB</a></li>
                                                                        <li><a href="Scanner_SMTP_Auxiliary_Modules">SMTP</a></li>
                                                                        <li><a href="Scanner_SNMP_Auxiliary_Modules">SNMP</a></li>
                                                                        <li><a href="Scanner_SSH_Auxiliary_Modules">SSH</a></li>
                                                                        <li><a href="Scanner_Telnet_Auxiliary_Modules">Telnet</a></li>
                                                                        <li><a href="Scanner_TFTP_Auxiliary_Modules">TFTP</a></li>
                                                                        <li><a href="Scanner_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                        <li><a href="Scanner_VNC_Auxiliary_Modules">VNC</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>Server
                                                                <ul class="two">
                                                                        <li><a href="Server_Capture_Auxiliary_Modules">Capture</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
			<br />
			<br />
			<br />
			<br />
			</ul>
													</div>
				
					<div class="clear"></div>
				</div>

				<div id="footer">
					<div id="footer-content">
						<div class="left">
							Copyright &copy; 2013 Offensive Security Ltd. All rights reserved.
						</div>
						<div class="right">
							<a href="http://www.offensive-security.com/"><img src="http://www.offensive-security.com/w/skins/msfu/offsec.png" alt="Offensive Security" /></a>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			
		</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script src="http://www.offensive-security.com/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=msfu&amp;*"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1981501-1");
pageTracker._trackPageview();
</script><!-- Served in 0.144 secs. --></body></html>